// (c) 2011-2012 Onswipe. All rights reserved.
// If you're reading this, go here: http://onswipe.com/about/#join

var onswipe={host:"http://synapse.onswipe.com",usernameRegex:/\?usr=([A-Za-z0-9\-]+)/,synapseElement:"script#onswipe_synapse",redirect:!1,supported:!1,standalone:!1,devicesSupported:["ipad","kindle_fire","android","iphone","nexus_chrome"]};onswipe.createIframe=function(e){var t=document.createElement("iframe");return t.src=e,t.name="onswipe_synapse_iframe",t.style.display="none",t},onswipe.getUsername=function(){var e=document.querySelector(onswipe.synapseElement),t=e&&e.src.match(onswipe.usernameRegex),n=t&&t[1];return n||!1},onswipe.handleMessage=function(e){if(e.origin==onswipe.host&&e.data&&~e.data.indexOf("redirect: http://")){var t=e.data.replace("redirect: ","");top===self?window.location=t:self.parent.location=t}},onswipe.determineDevice=function(){var e="unknown",t=navigator.userAgent.toLowerCase();return ~t.indexOf("ipad")?e="ipad":~t.indexOf("silk")||~t.indexOf("kindle")?e="kindle_fire":~t.indexOf("android")?~t.indexOf("nexus 7")&&~t.indexOf("chrome")?e="nexus_chrome":~t.indexOf("mobile")?e="android_mobile":e="android_tablet":~t.indexOf("iphone")&&(e="iphone"),e},navigator&&navigator.standalone&&(onswipe.standalone=!0),~document.URL.indexOf("onswipe_redirect=no")?onswipe.redirect="no":~document.URL.indexOf("onswipe_redirect=never")&&(onswipe.redirect="never"),onswipe.device=onswipe.determineDevice(),~onswipe.devicesSupported.indexOf(onswipe.device)&&(onswipe.supported=!0),onswipe.usr=onswipe.getUsername(),onswipe.supported&&!onswipe.redirect&&(document.referrer?onswipe.referrer=document.referrer:onswipe.referrer="",onswipe.frameUrl=onswipe.host+"/v2/frame"+"?usr="+onswipe.usr+"&url="+encodeURIComponent(location.href)+"&device="+onswipe.device+"&ref="+encodeURIComponent(onswipe.referrer),onswipe.iframe=onswipe.createIframe(onswipe.frameUrl),document.head.appendChild(onswipe.iframe),window.addEventListener("message",onswipe.handleMessage,!1)),onswipe.redirect=="never"&&(onswipe.frameUrl=onswipe.host+"/v2/out?usr="+onswipe.usr,onswipe.iframe=onswipe.createIframe(onswipe.frameUrl),document.head.appendChild(onswipe.iframe))