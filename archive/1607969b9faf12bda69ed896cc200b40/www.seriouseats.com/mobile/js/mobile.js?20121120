var contentHTML;
var tabHTML;
var tabHREF;
var currentBlog;

$(document).ready(function() {
	$(".mobile-tab").click(function() {
		var tabID = $(this).attr("id").replace("-tab", "");
		//alert (tabID);
		//var whichPage = $(this).parents("a").attr("href");
		//alert (whichPage);
		//$(".mobileTab").css("background-color", "#6e1409");
		$(".mobile-tab").removeClass("active");
		$(".mobile-page").hide();
		//alert ("#" + $(this).attr("id"));
		//alert ($(document).find("#" + $(this).attr("id")).length);
		$(document).find("#" + $(this).attr("id")).each(function()
			{
				
				$(this).addClass("active");
			});
		//check to see if this element exists, if so, show
		$("#" + tabID).show();
		window.scrollTo(0,0);
	});
	
	$("#expand-collapse-comments").click(function() {
		if ($(this).hasClass("collapsed")) {
			$(this).attr('src', 'http://static.seriouseats.com/mobile/images/icons/icon_minus.jpg');
			$(this).removeClass("collapsed");
			$(this).addClass("expanded");
			$("#user-comments").show();
			// show comments + pagination, change image to collapse icon
		}
		else {
			// hide comment + pagination, change image to expand icon
			$(this).attr('src', 'http://static.seriouseats.com/mobile/images/icons/icon_plus.jpg');	
			$(this).removeClass("expanded");
			$(this).addClass("collapsed");
			$("#user-comments").hide();
                        //alert('Before scroll into view');
                        document.getElementById('comment-section').scrollIntoView();
                        //alert('After scroll into view');
		}
	});

	
		$("#expand-collapse-posts").click(function() {
		if ($(this).hasClass("collapsed")) {
			$(this).attr('src', 'http://static.seriouseats.com/mobile/images/icons/icon_minus.jpg');
			$(this).removeClass("collapsed");
			$(this).addClass("expanded");
			$("#user-posts").show();
			//showMoreComments();
			// show comments + pagination, change image to collapse icon
		}
		else {
			// hide comment + pagination, change image to expand icon
			$(this).attr("src", "http://static.seriouseats.com/mobile/images/icons/icon_plus.jpg");	
			$(this).removeClass("expanded");
			$(this).addClass("collapsed");
			$("#user-posts").hide();
		}
	});
	
	
		$("#expand-collapse-favorites").click(function() {
		if ($(this).hasClass("collapsed")) {
			$(this).attr('src', 'http://static.seriouseats.com/mobile/images/icons/icon_minus.jpg');
			$(this).removeClass("collapsed");
			$(this).addClass("expanded");
			$("#user-favorites").show();
			//showMoreComments();
			// show comments + pagination, change image to collapse icon
		}
		else {
			// hide comment + pagination, change image to expand icon
			$(this).attr("src", "http://static.seriouseats.com/mobile/images/icons/icon_plus.jpg");	
			$(this).removeClass("expanded");
			$(this).addClass("collapsed");
			$("#user-favorites").hide();
		}
	});
	
	/*$("#se-tab").click(function() {
		//alert ("clicked se tab");
		$(this).css("background-color", "#6e1409");
		$("#se-home").show();
		$("#more-tab").css("background-color", "#f09f1a");
		$("#se-more").hide();
	});
	
	$("#more-tab").click(function() {
		//alert ("clicked more tab");
		$(this).css("background-color", "#f09f1a");
		$("#se-more").show();
		$("#se-tab").css("background-color", "#6e1409");
		$("#se-home").hide();
	});  */   
}); 

$(window).load(function() {
// initialize scrollable
	//alert ("screen width is: " + screen.width);
	//$("body").css("width", screen.width);
	//$(".scrollable").each(function(){
	//    alert ($(this).find(".items").height());
	//});
	$(".scrollable").css("width", $(window).width());
	$(".scroll-item").css("width", $(window).width());
	//alert ("set scrollable width: " + $(".scrollable").css("width"));
	//$(".scrollable").scrollable({ circular: true });
	$(".scrollable").scrollable({ 
			circular: true,
                        keyboard: false,
                        vertical: false,
			onSeek: function()  {  
				var index = this.getIndex(); 
				//alert (index);
				this.getItemWrap().parents('.scrollable-section').find('#panel-count').html(index+1);
				var activeItem = this.getItems().get(index);
				var newHeight = activeItem.clientHeight;
				this.getItemWrap().parents('.scrollable').css("height", newHeight);
				//alert (activeItem.html());
				//alert (parentEls);
				//$(this).parents('.scrollable-section').find('#count').html(index+1);
			}
			//,
			//onClick: function() {
			//	alert ("on click");
			//	this.focus();
			//}
	});
	$(".prev-button").click(function() {
		//$(this).parents('.scrollable-section').find('.scrollable').data('scrollable').focus();
		/*var parentEls = $(this).parents('.scrollable-section').map(function () { 
			  return this.tagName; 
			}).get().join(", ");
		alert (parentEls);*/
		//alert ($(this).parents('.scrollable-section').find('.scrollable').data('scrollable').getIndex());
		//if ($(this).parents('.scrollable-section').attr('id') == 'mobile-se-featured')
		//{
		//	var numSections = 5;
		//}
		//else
		//{
		 //   var numSections = 4;	
		//}
		$(this).parents('.scrollable-section').find('.scrollable').data('scrollable').prev();
		//var index = $(this).parents('.scrollable-section').find('.scrollable').data('scrollable').getIndex();
		//alert (index);
		//if (index < 0) index = numSections - 1;
		//$(this).parents('.scrollable-section').find('#count').html(index+1);
	});
	$(".next-button").click(function() {
		//alert ($(this).parents('.scrollable-section').find('.scrollable').data('scrollable').getIndex());
		$(this).parents('.scrollable-section').find('.scrollable').data('scrollable').next();
		//var index = $(this).parents('.scrollable-section').find('.scrollable').data('scrollable').getIndex();
		//alert (index);
		//if (index < 0) index = 0;
		//$(this).parents('.scrollable-section').find('#count').html(index+1);
	});

	$(".scrollable").each(function(){
		var height;
		var scrollItems = $(this).find(".scroll-item").not(".cloned");
		height = scrollItems.height();
		$(this).css("height", height);
		
		//alert ($(this).height());
				/* var maxHeight = 0; 
				 $(this).find(".scroll-item").each(function(){
					 //alert($(this).html());
					 //alert($(this).attr("id"));
					 //alert($(this).height());
					 if ($(this).height() > maxHeight) 
			 {
				 maxHeight = $(this).height();
			 }
				 });
				 //alert ("max height is: " + maxHeight);
				 $(this).css("height", maxHeight);
				// $("#mobile-se-recent .scrollable").css("height", maxHeight);*/

	});
	
//alert('height of recent se posts 2: ' + $("#mobile-se-recent2").height());
////alert('height of recent se posts 3: ' + $("#mobile-se-recent3").height());
///alert('height of recent se posts 4: ' + $("#mobile-se-recent4").height());
	//iterate through the sections, find the largest height, set the height for the scrollable for that section.

});


<!--
function mtUpdateSignInWidget() {
   // alert ('in mtUpdateSignInWidget');
   var user = mtGetUser();
  /*if (WebKitDetect.mobileDevice()) {
	  if (user && user.is_authenticated) {
		 $('#tools').html('<a href="javascript:void(0)" onclick="return mtSignOutOnClick()">Log out</a>');
	  } else {
		 $('#tools').html('<a href="javascript:void(0)" onclick="return mtSignInOnClick(\'signin-widget-content\')">Login</a>');
	  }
   }*/

   if (user && user.is_authenticated) {
      var userProfileURL = 'http://mobile.seriouseats.com/user/profile';
      var signinHTML = '<div class="float-right"><span id="accountLink"><a href="http://mobile.seriouseats.com/cgi-bin/mte/mt-cp.cgi?__mode=edit&tmpl_id=3303&blog_id=31&return_to=' + encodeURIComponent(document.URL) + '">Account</a></span> ';
      if ((typeof(hideLogoutLink) == 'undefined') || (!hideLogoutLink)) signinHTML += '| <span id="loginLink"><a href="javascript:void(0)" onclick="return mtSignOutOnClick()">Log Out</a></span>';
      signinHTML += '</div><div id="profileLink">Hello, <a href="' + userProfileURL + '">' + user.name + '</a>.</div>';
	  $('#signin-widget-content').html(signinHTML);      
	  $('#login-signup-to-comment').hide();
	  //html("");
	  $("#post-comment").show();   

   } else {
	  $('#signin-widget-content').html('<div class="float-right" id="logged-out-links"><a href="http://mobile.seriouseats.com/user/register">Sign Up</a>&nbsp;&nbsp;|&nbsp;&nbsp;<a href="javascript:void(0)" onclick="return mtSignInOnClick(\'signin-widget-content\')">Login</a></div><div class="clearer"></div>');      
	  $('#login-signup-to-comment').show();
	  //html("<div class=\"commentGuidelines\"><h3>Hello Eater!</h3><p>To start talking, please <a href=\"javascript:void(0)\" onclick=\"return mtSignInOnClick('signin-widget-content')\">log in</a> or <a href=\"http://mobile.seriouseats.com/cgi-bin/mte/mt-cp.cgi?__mode=register&blog_id=31&return_to=" + encodeURIComponent('http://mobile.seriouseats.com/welcome/') + "\">sign up</a> &mdash; it's fast and free!</p></div>  &nbsp;");
	  $("#post-comment").hide();   
   }
}

$(function(){ mtUpdateSignInWidget();});
mtAttachEvent('usersignin', mtUpdateSignInWidget);

function checkInputPlaceholders()
{
	//alert ("check input placeholders");
	//if (Modernizr.input.placeholder) {
	  // your placeholder text should already be visible!
	//} else {
		/*$('.search-query').each(function() {
		   $(this).attr('value', 'SEARCH');	   
		});*/
	
		$('.search-query').focus(function () {
			if ($(this).val() == $(this).attr("title")) {
				$(this).val("");
			}
		}).blur(function () {
			if ($(this).val() == "") {
				$(this).val($(this).attr("title"));
			}
		});
		
		$('.formText').focus(function () {
			if ($(this).val() == $(this).attr("title")) {
				$(this).val("");
			}
		}).blur(function () {
			if ($(this).val() == "") {
				$(this).val($(this).attr("title"));
			}
		});
	//}
}

function showMorePage(twitterLink, tabPrefix) {
	// depending on which blog you're in, set Twitter link to that blog's Twitter
	// http://go.seriouseats.com/?id=3781X630295&amp;xs=1&amp;url=http%3A%2F%2Ftwitter.com%2Fseriouseats&amp;sref=http%3A%2F%2Fwww.seriouseats.com%2F
	var twitterClass = '';
	var arrayOfBlogsUsingOrangeTwitterIcon = [ 'se', 're'];
	if (jQuery.inArray(tabPrefix, arrayOfBlogsUsingOrangeTwitterIcon) <= -1) {
		twitterClass = ' class="white-text"';
	}
	var twitterHTML = '<div id="twitter-link"' + twitterClass + '><a href="http://www.twitter.com/' + twitterLink + '">Follow us on Twitter!</a></div>';
	$('.banner-right-section').each(function()
	{
		$(this).html(twitterHTML);
	});
	
	tabHTML = $('a#' + tabPrefix + '-tab').html();	
	tabHREF = $('a#' + tabPrefix + '-tab').attr('href');
	currentBlog = tabPrefix;

	// alert (tabHTML + ", " + tabHREF);
	
	$('a#more-tab').each(function()
	{
		$(this).addClass(tabPrefix + '-tab');
	});
	
	/*$('a#' + tabPrefix + '-tab').click(function()
	{
		goBack();
		//return false;
	});*/
	
	$('a#' + tabPrefix + '-tab').each(function()
	{
		//alert ("in this function");
		$(this).removeClass(tabPrefix + '-tab');
		//alert ($(this).attr('href'));
		//$(this).removeAttr('href');
		//alert ($(this).attr('href'));
		$(this).attr('onClick', 'window.location.reload(); return false;');
		$(this).html('Go Back');
	});

	
	// Load the more page HTML into the mobile-content div
	
	//alert ('before getting content for more section');
	/*$.get('more.html', function(data) {
		alert (data);
    	$('#mobile-content').html(data);
    	//alert('Load was performed.');
	});	*/
	
	contentHTML = $('#mobile-content').html();
	// alert (contentHTML);
	
        /*var moreURL = 'http://mobile.seriouseats.com/more.html';*/

        /*( if (location.hostname == "www.seriouseats.com") {
           var moreURL = 'http://mobile.seriouseats.com/more.html';
        } else {*/
           var moreURL = 'http://' + location.hostname + '/more.html';
       /* }
        alert (moreURL); */

	$('#mobile-content').load(moreURL, function()
	{
		// record pageview in Google Analytics
		//alert ("Load was performed.");
		//alert($('#mobile-content').html());
		checkInputPlaceholders();
	});
	
	//alert($('#mobile-content').html());
	//checkInputPlaceholders();
	
	//$.get('../more.html', function(data) {
	//alert (data);
   // $('#mobile-content').html(data);
   // alert('Load was performed.');
//});
	
	// record link

// record click on "more" link in Google analytics

     //alert (window.location.href + 'more-tab');
     pageTracker._trackPageview(window.location.href + 'more-tab');

     window.scrollTo(0,0);
}

function goBack() {
	/*var searchBox = '<div id="search-box">';
	searchBox += '<form action="/search/">';
	searchBox += '<input name="q" type="search" class="search-query" title="SEARCH" placeholder="SEARCH" value="SEARCH"/>';
	searchBox += '<input name="search-button" type="submit" class="search-button" value="&#187;"/>';
	searchBox += '</form>';
	searchBox += '</div>';

	$('.banner-right-section').each(function()
	{
		$(this).html(searchBox);
	});
	
	$('a#' + currentBlog + '-tab').each(function()
	{
		$(this).addClass(currentBlog + '-tab');
		$(this).attr('href', tabHREF);
		$(this).html(tabHTML);
	});
	
	$('a#more-tab').each(function()
	{
		$(this).removeClass(currentBlog + '-tab');
	});*/

	//$('#mobile-content').html(contentHTML);
	
	//return false;
	//exit();
	//alert ('done with content');
	//checkInputPlaceholders();
}

function showLoadingScreen()
{
	$('#loadingScreen').show();
}

function showCommentProcessingMessage()
{
	$('#commented').html('<p>Please wait while your comment is being processed...</p>');
	$('#commented').show();
}

function showCommentSubmittedMessage()
{
	$('#commented').html('<p>Thanks for commenting!<br />Your comment has been accepted<br />and will appear within a minute.</p>');
	$('#commented').show();
}

	function showMoreComments()
	{
		$('#comments-list').append(getComments(startIndex, endIndex));
		if (endIndex == numComments) {
			if ($('#show-more-comments-button').css('display') == 'inline-block') {
				$('#show-more-comments-button').hide();
			}
			if ($('#show-all-comments-button').css('display') == 'inline-block') {
				$('#show-all-comments-button').hide();
			}			
			if ($('#hide-all-comments-button').css('display') == 'none') {
				$('#hide-all-comments-button').show();
			}			
		} else {
			startIndex= endIndex;
			endIndex = (numComments <= (endIndex + numItemsPerScreen)) ? numComments : endIndex + numItemsPerScreen;
			if ($('#show-more-comments-button').css('display') == 'none') {
				$('#show-more-comments-button').show();
			}	
			if ($('#show-all-comments-button').css('display') == 'none') {
				$('#show-all-comments-button').show();
			}			
		}
	}
	
	function showAllComments()
	{
		$('#comments-list').append(getComments(startIndex, numComments));
			if ($('#show-more-comments-button').css('display') == 'inline-block') {
				$('#show-more-comments-button').hide();
			}
			if ($('#show-all-comments-button').css('display') == 'inline-block') {
				$('#show-all-comments-button').hide();
			}			
			if ($('#hide-all-comments-button').css('display') == 'none') {
				$('#hide-all-comments-button').show();
			}	

	}
	
	function getComments(startIndex, endIndex)
	{
	    var commentContent = '';

		for (var i = startIndex;i < endIndex;i++) {
			if (i%2) {
				commentContent += '<div class="comment yellow">';
			} else {
				commentContent += '<div class="comment green">';
			}
			
			
			commentContent += '<p>' + commentJSON[i]["text"].replace(regex, "<br />") + '</p><p class="commenter postFooter"><a href="http://mobile.seriouseats.com/user/profile/' + commentJSON[i]["author_username"] + '">' + decodeURIComponent(escape(commentJSON[i]["author_nickname"])) + '</a> at ';
			var date = commentJSON[i]["created_on"];
			var commentDate = new Date(date.substr(0,4), date.substr(4,2)-1, date.substr(6,2), date.substr(8,2), date.substr(10,2), date.substr(12,2));	
			commentContent += commentDate.toString("h:mmtt on MM/dd/yy") + '</p>';
			commentContent += '</div><!-- close comment -->';
		}	
		return commentContent;
	}
	
	$('#show-more-comments-button').click(function() {
		showMoreComments();
	});
	
	$('#show-all-comments-button').click(function() {
		showAllComments();
	});
	
	$('#hide-all-comments-button').click(function() {
		$("#expand-collapse-comments").attr('src', 'http://static.seriouseats.com/mobile/images/icons/icon_plus.jpg');	
		$("#expand-collapse-comments").removeClass("expanded");
		$("#expand-collapse-comments").addClass("collapsed");
		$("#user-comments").hide();
                //alert ('before scroll into view');
                document.getElementById('comment-section').scrollIntoView();
                //alert ('after scroll into view');

		//$("#comments-list").html("");
		//$('#hide-all-comments-button').hide();
	});

function setMobileCookie()
{
   document.cookie='overrideMobileRedirect=true;max-age=31536000;path=/;domain=seriouseats.com;'
}

//-->
        
