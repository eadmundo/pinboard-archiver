sailthru={setup:function(b){if(sailthru.alreadySetup){return}sailthru.alreadySetup=true;var c={tags:sailthru.getContentTags(),spider:true,concierge:false};for(var a in b){c[a]=b[a]}if(!c.domain){return}if(c.concierge&&navigator.cookieEnabled&&sailthru.getCookie("sailthru_recommendation_hidden")!="true"){if(c.concierge===true){c.concierge={from:"top",threshold:400}}sailthru._recommendationBox(c)}else{if(c.tags||c.spider){sailthru._horizonTrack(c)}}if(c.mynews){sailthru.myNews(c)}},myNews:function(b){var c=b.number||10;var a="http://"+b.domain+"/horizon/recommend?format=jsonp&number="+(c+5);sailthru.myNewsConfig={number:c,nextItem:c};sailthru.jq.ajax(a,{dataType:"jsonp",success:function(f){sailthru.myNewsConfig.content=f.content;var e="";for(var d=0;d<c;d++){e+=sailthru.getMyNewsItemHtml(f.content[d])}sailthru.jq("#mynews").html(e);sailthru.jq("#mynews a").click(function(){sailthru.jq(this).parents(".content-item").fadeOut("slow");sailthru.myNewsAddNextItem()})}})},myNewsAddNextItem:function(){if(sailthru.myNewsConfig.nextItem>=sailthru.myNewsConfig.content.length){}else{var a=sailthru.getMyNewsItemHtml(sailthru.myNewsConfig.content[sailthru.myNewsConfig.nextItem]);sailthru.myNewsConfig.nextItem++;$("#mynews").append(a).find(".content-item:last").hide().fadeIn()}},getMyNewsItemHtml:function(b){var a="";a+='<div class="content-item">';if(b.image){a+='<div class="image"><a href="'+b.url+'" target="_blank"><img src="'+b.image.thumb+'" /></a></div>'}a+='<div class="title"><a href="'+b.url+'" target="_blank">'+b.title+"</a></div>";a+="</div>";return a},recommendationBox:function(a){sailthru.setup({domain:a.domain,concierge:a})},horizonTrack:function(a){sailthru._horizonTrack(a)},getContentTags:function(){if(window.sailthru_horizon){return window.sailthru_horizon.tags}var a=document.getElementsByTagName("meta");for(var b in a){if(a[b].name&&a[b].name.toLowerCase()=="sailthru.tags"){return a[b].content}}for(var b in a){if(a[b].name&&a[b].name.toLowerCase()=="keywords"){return a[b].content}}return null},recommendationBoxCallback:function(a){sailthru.jq(document).trigger("SailthruDataLoaded",[a])},setCookie:function(b,c,d){var a=new Date();a.setDate(a.getDate()+d);document.cookie=b+"="+escape(c)+((d==null)?"":";expires="+a.toUTCString())},getCookie:function(b){var e=b+"=",a=document.cookie.split(";"),d,f;for(d=0;d<a.length;d++){f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return f.substring(e.length,f.length)}}return null},tagsToString:function(a){if(a instanceof Array){return a.join(",")}else{return a}},_horizonTrack:function(c){if(!c.domain){return}var b="http://"+c.domain+"/horizon/track?r="+Math.random();b+="&url="+encodeURIComponent(document.location);if(c.tag){c.tags=c.tag}if(c.tags){if(c.tags instanceof Array){b+="&tags="+encodeURIComponent(c.tags.join(","))}else{if(c.tags instanceof Object){for(k in c.tags){b+="&tags["+encodeURIComponent(k)+"]="+encodeURIComponent(c.tags[k])}}else{b+="&tags="+encodeURIComponent(c.tags)}}}if(c.spider){b+="&spider=1"}if(c.append){var a=document.createElement("img");a.setAttribute("src",b);document.body.appendChild(a)}else{document.write('<img src="'+b+'" />')}},recommendationTrack:function(e,f,d,a){if(!self.tracked){self.tracked={}}if(self.tracked[d]){return}self.tracked[d]=true;var c="http://"+e+"/horizon/recommendtrack?id="+f;if(d){c+="&event="+d}if(a){for(var b in a){c+="&"+b+"="+encodeURIComponent(a[b])}}c+="&cb="+Math.random();sailthru.jq("body").append('<img src="'+c+'" />')},_recommendationBox:function(d){var c=this;this.defaults={from:"bottom",threshold:100,delay:null,offsetBottom:0,url:"http://"+d.domain+"/recommend?format=jsonp&callback=?",cssPath:"http://cdn.sailthru.com/assets/css/horizon/recommendation.css",showReadMore:false};var a=sailthru.jq.extend({},this.defaults,d.concierge),h=null,f=false;a.domain=d.domain;if(d.concierge.filter&&d.concierge.filter.tags){a.url=a.url+"&filter[tags]="+sailthru.tagsToString(d.filter.tags)}if(!d.spider){a.url=a.url+"&nospider=1"}if(d.tags){a.url=a.url+"&tags="+sailthru.tagsToString(d.tags)}this.data={};function g(){e(a.cssPath);sailthru.jq(document).bind("SailthruDataLoaded",function(j,i){c.data=i;f=true;b()});sailthru.jq.getJSON(a.url);sailthru.jq(window).scroll(function(n){if(f){var m=sailthru.jq(this),l=m.scrollTop(),j=sailthru.jq(document).height()-sailthru.jq(window).height();if(a.threshold instanceof jQuery){var i=0-(a.threshold.eq(0).offset().top-sailthru.jq(window).height()),o=0}else{var i=(a.from=="bottom")?a.threshold:-a.threshold,o=(a.from=="bottom")?j:0}if(l>=(o-i)){c.show()}else{c.hide()}}});if(d.delay){h=setTimeout(function(){clearTimeout(h);c.show()},d.delay)}}function e(i){sailthru.jq('<link href="'+i+'" type="text/css" rel="stylesheet" />').appendTo("head")}function b(){var n=c.data.content,i,s,l;i=sailthru.jq('<div class="recommendation sailthruRecommendation" />');if(typeof n.html!="undefined"){i.html(n.html);s=i.find("a.closeRecommendation");l=i.find("a.openRecommendation");i.appendTo("body")}else{var s=sailthru.jq('<a class="closeRecommendation imgReplace" href="javascript:void(0);"><span>Close</span></a>'),l=sailthru.jq('<a class="openRecommendation imgReplace" href="javascript:void(0);"><span>Open</span></a>'),o=sailthru.jq('<div class="openWrapper" />'),q=sailthru.jq('<div class="recommendationWrapper" />'),u=sailthru.jq('<div class="recommendationThumb" />'),p=sailthru.jq('<div class="recommendationDetails" />'),r=sailthru.jq('<span class="recommendationCategory row">Recommended for You</span>'),j=sailthru.jq('<span class="recommendationTitle row"><a href="'+n.url+'">'+n.title+"</a></span>"),t=sailthru.jq('<a class="recommendationLink" href="'+n.url+'">Read More &gt;</a>'),m=sailthru.jq('<div class="recommendationFooter"><a href="http://sailthru.com/">Powered by Sailthru</a></div>');o.append(l);p.append(r,j,t);q.append(u,p);i.append(s,o,q,m).appendTo("body");(n.thumb)?u.append('<img src="'+n.thumb+'" />'):u.hide();if(!a.showReadMore){t.hide()}}s.click(function(v){v.preventDefault();sailthru.setCookie("sailthru_recommendation_hidden","true",30);c.hide();return false});l.click(function(v){v.preventDefault();sailthru.setCookie("sailthru_recommendation_hidden","false",30);c.show();return false});setTimeout(function(){var v=sailthru.jq('<iframe src="" FRAMEBORDER="0" />');i.css({bottom:a.offsetBottom,zIndex:"10000"});v.css({position:"fixed",width:i.outerWidth(),height:i.outerHeight(),zIndex:"9999",right:0,bottom:a.offsetBottom,display:"none"});if(sailthru.jq.browser.msie){i.add(v).addClass("ie");if(sailthru.jq.browser.version=="6.0"){i.add(v).addClass("ie6")}}if(i.is(".ie6")){i.add(v).css("position","absolute")}v.appendTo("body");c.$elem=i;c.$iframe=v},100)}this.show=function(){if(!navigator.cookieEnabled){return false}if(sailthru.getCookie("sailthru_recommendation_hidden")=="true"){return false}if(this.$elem&&!this.$elem.is(":animated")){this.$elem.find(".openWrapper").hide();this.$iframe.show();this.$elem.show().animate({right:0},"normal")}sailthru.recommendationTrack(a.domain,c.data.content.id,"show",c.data.track)};this.hide=function(){if(this.$elem&&!this.$elem.is(":animated")){var i=this.$elem.find(".openWrapper"),m=i.children("a"),l=(this.$elem.outerHeight()/2)-11;m.css("margin-top",l);i.show();var j=c.$elem.outerWidth()-i.outerWidth();this.$elem.animate({right:-j},"normal",function(){c.$iframe.hide()})}};g()}};if(window.$){sailthru.jq=$}if(window.sailthru_horizon){window.setTimeout(function(){sailthru.setup({spider:true,domain:sailthru_horizon.domain,tags:sailthru_horizon.tags?sailthru_horizon.tags:sailthru_horizon.tag,append:true})},100)};