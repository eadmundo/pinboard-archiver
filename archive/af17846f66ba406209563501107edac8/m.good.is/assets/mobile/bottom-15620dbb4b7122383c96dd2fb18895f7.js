/**
 * Date.parse with progressive enhancement for ISO 8601 <https://github.com/csnover/js-iso8601>
 * Â© 2011 Colin Snover <http://zetafleet.com>
 * Released under MIT license.
 */
function parseUri(e){var t=parseUri.options,n=t.parser[t.strictMode?"strict":"loose"].exec(e),r={},i=14;while(i--)r[t.key[i]]=n[i]||"";return r[t.q.name]={},r[t.key[12]].replace(t.q.parser,function(e,n,i){n&&(r[t.q.name][n]=i)}),r}(function(e,t){var n=e.parse,r=[1,4,5,6,7,10,11];e.parse=function(i){var s,o,u=0;if(o=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(i)){for(var a=0,f;f=r[a];++a)o[f]=+o[f]||0;o[2]=(+o[2]||1)-1,o[3]=+o[3]||1,o[8]!=="Z"&&o[9]!==t&&(u=o[10]*60+o[11],o[9]==="+"&&(u=0-u)),s=e.UTC(o[1],o[2],o[3],o[4],o[5]+u,o[6],o[7])}else s=n?n(i):NaN;return s}})(Date),function(e,t){var n;e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not(button[type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input:file",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,r){var i=e.Event(n);return t.trigger(i,r),i.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(r){var i,s,o,u,a,f;if(n.fire(r,"ajax:before")){u=r.data("cross-domain")||null,a=r.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType;if(r.is("form")){i=r.attr("method"),s=r.attr("action"),o=r.serializeArray();var l=r.data("ujs:submit-button");l&&(o.push(l),r.data("ujs:submit-button",null))}else r.is(n.inputChangeSelector)?(i=r.data("method"),s=r.data("url"),o=r.serialize(),r.data("params")&&(o=o+"&"+r.data("params"))):(i=r.data("method"),s=n.href(r),o=r.data("params")||null);return f={type:i||"GET",data:o,dataType:a,crossDomain:u,beforeSend:function(e,i){return i.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+i.accepts.script),n.fire(r,"ajax:beforeSend",[e,i])},success:function(e,t,n){r.trigger("ajax:success",[e,t,n])},complete:function(e,t){r.trigger("ajax:complete",[e,t])},error:function(e,t,n){r.trigger("ajax:error",[e,t,n])}},s&&(f.url=s),n.ajax(f)}return!1},handleMethod:function(r){var i=n.href(r),s=r.data("method"),o=r.attr("target"),u=e("meta[name=csrf-token]").attr("content"),a=e("meta[name=csrf-param]").attr("content"),f=e('<form method="post" action="'+i+'"></form>'),l='<input name="_method" value="'+s+'" type="hidden" />';a!==t&&u!==t&&(l+='<input name="'+a+'" value="'+u+'" type="hidden" />'),o&&f.attr("target",o),f.hide().append(l).appendTo("body"),f.submit()},disableFormElements:function(t){t.find(n.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(n.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t=e.data("confirm"),r=!1,i;return t?(n.fire(e,"confirm")&&(r=n.confirm(t),i=n.fire(e,"confirm:complete",[r])),r&&i):!0},blankInputs:function(t,n,r){var i=e(),s,o=n||"input,textarea";return t.find(o).each(function(){s=e(this);if(r?s.val():!s.val())i=i.add(s)}),i.length?i:!1},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},callFormSubmitBindings:function(n,r){var i=n.data("events"),s=!0;return i!==t&&i.submit!==t&&e.each(i.submit,function(e,t){if(typeof t.handler=="function")return s=t.handler(r)}),s},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return n.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.data("ujs:enable-with",!1)),e.unbind("click.railsDisable")}},e.ajaxPrefilter(function(e,t,r){e.crossDomain||n.CSRFProtection(r)}),e(document).delegate(n.linkDisableSelector,"ajax:complete",function(){n.enableElement(e(this))}),e(document).delegate(n.linkClickSelector,"click.rails",function(r){var i=e(this),s=i.data("method"),o=i.data("params");if(!n.allowAction(i))return n.stopEverything(r);i.is(n.linkDisableSelector)&&n.disableElement(i);if(i.data("remote")!==t)return(r.metaKey||r.ctrlKey)&&(!s||s==="GET")&&!o?!0:(n.handleRemote(i)===!1&&n.enableElement(i),!1);if(i.data("method"))return n.handleMethod(i),!1}),e(document).delegate(n.inputChangeSelector,"change.rails",function(t){var r=e(this);return n.allowAction(r)?(n.handleRemote(r),!1):n.stopEverything(t)}),e(document).delegate(n.formSubmitSelector,"submit.rails",function(r){var i=e(this),s=i.data("remote")!==t,o=n.blankInputs(i,n.requiredInputSelector),u=n.nonBlankInputs(i,n.fileInputSelector);if(!n.allowAction(i))return n.stopEverything(r);if(o&&i.attr("novalidate")==t&&n.fire(i,"ajax:aborted:required",[o]))return n.stopEverything(r);if(s)return u?n.fire(i,"ajax:aborted:file",[u]):!e.support.submitBubbles&&e().jquery<"1.7"&&n.callFormSubmitBindings(i,r)===!1?n.stopEverything(r):(n.handleRemote(i),!1);setTimeout(function(){n.disableFormElements(i)},13)}),e(document).delegate(n.formInputClickSelector,"click.rails",function(t){var r=e(this);if(!n.allowAction(r))return n.stopEverything(t);var i=r.attr("name"),s=i?{name:i,value:r.val()}:null;r.closest("form").data("ujs:submit-button",s)}),e(document).delegate(n.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&n.disableFormElements(e(this))}),e(document).delegate(n.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&n.enableFormElements(e(this))})}(jQuery),function(e){e.extend(e.fn,{validate:function(t){if(!this.length){t&&t.debug&&window.console;return}var n=e.data(this[0],"validator");if(n)return n;this.attr("novalidate","novalidate"),n=new e.validator(t,this[0]),e.data(this[0],"validator",n);if(n.settings.onsubmit){var r=this.find("input, button");r.filter(".cancel").click(function(){n.cancelSubmit=!0}),n.settings.submitHandler&&r.filter(":submit").click(function(){n.submitButton=this}),this.submit(function(t){function r(){if(n.settings.submitHandler){if(n.submitButton)var t=e("<input type='hidden'/>").attr("name",n.submitButton.name).val(n.submitButton.value).appendTo(n.currentForm);return n.settings.submitHandler.call(n,n.currentForm),n.submitButton&&t.remove(),!1}return!0}return n.settings.debug&&t.preventDefault(),n.cancelSubmit?(n.cancelSubmit=!1,r()):n.form()?n.pendingRequest?(n.formSubmitted=!0,!1):r():(n.focusInvalid(),!1)})}return n},valid:function(){if(e(this[0]).is("form"))return this.validate().form();var t=!0,n=e(this[0].form).validate();return this.each(function(){t&=n.element(this)}),t},removeAttrs:function(t){var n={},r=this;return e.each(t.split(/\s/),function(e,t){n[t]=r.attr(t),r.removeAttr(t)}),n},rules:function(t,n){var r=this[0];if(t){var i=e.data(r.form,"validator").settings,s=i.rules,o=e.validator.staticRules(r);switch(t){case"add":e.extend(o,e.validator.normalizeRule(n)),s[r.name]=o,n.messages&&(i.messages[r.name]=e.extend(i.messages[r.name],n.messages));break;case"remove":if(!n)return delete s[r.name],o;var u={};return e.each(n.split(/\s/),function(e,t){u[t]=o[t],delete o[t]}),u}}var a=e.validator.normalizeRules(e.extend({},e.validator.metadataRules(r),e.validator.classRules(r),e.validator.attributeRules(r),e.validator.staticRules(r)),r);if(a.required){var f=a.required;delete a.required,a=e.extend({required:f},a)}return a}}),e.extend(e.expr[":"],{blank:function(t){return!e.trim(""+t.value)},filled:function(t){return!!e.trim(""+t.value)},unchecked:function(e){return!e.checked}}),e.validator=function(t,n){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=n,this.init()},e.validator.format=function(t,n){return arguments.length==1?function(){var n=e.makeArray(arguments);return n.unshift(t),e.validator.format.apply(this,n)}:(arguments.length>2&&n.constructor!=Array&&(n=e.makeArray(arguments).slice(1)),n.constructor!=Array&&(n=[n]),e.each(n,function(e,n){t=t.replace(new RegExp("\\{"+e+"\\}","g"),n)}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e,t){this.lastActive=e,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(e)).hide())},onfocusout:function(e,t){!this.checkable(e)&&(e.name in this.submitted||!this.optional(e))&&this.element(e)},onkeyup:function(e,t){(e.name in this.submitted||e==this.lastElement)&&this.element(e)},onclick:function(e,t){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,n,r){t.type==="radio"?this.findByName(t.name).addClass(n).removeClass(r):e(t).addClass(n).removeClass(r)},unhighlight:function(t,n,r){t.type==="radio"?this.findByName(t.name).removeClass(n).addClass(r):e(t).removeClass(n).addClass(r)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:e.validator.format("Please enter no more than {0} characters."),minlength:e.validator.format("Please enter at least {0} characters."),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long."),range:e.validator.format("Please enter a value between {0} and {1}."),max:e.validator.format("Please enter a value less than or equal to {0}."),min:e.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function r(t){var n=e.data(this[0].form,"validator"),r="on"+t.type.replace(/^validate/,"");n.settings[r]&&n.settings[r].call(n,this[0],t)}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var t=this.groups={};e.each(this.settings.groups,function(n,r){e.each(r.split(/\s/),function(e,r){t[r]=n})});var n=this.settings.rules;e.each(n,function(t,r){n[t]=e.validator.normalizeRule(r)}),e(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",r).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",r),this.settings.invalidHandler&&e(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){t=this.validationTargetFor(this.clean(t)),this.lastElement=t,this.prepareElement(t),this.currentElements=e(t);var n=this.check(t);return n?delete this.invalid[t.name]:this.invalid[t.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),n},showErrors:function(t){if(t){e.extend(this.errorMap,t),this.errorList=[];for(var n in t)this.errorList.push({message:t[n],element:this.findByName(n)[0]});this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t=0;for(var n in e)t++;return t},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(t){}},findLastActive:function(){var t=this.lastActive;return t&&e.grep(this.errorList,function(e){return e.element.name==t.name}).length==1&&t},elements:function(){var t=this,n={};return e(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in n||!t.objectLength(e(this).rules())?!1:(n[this.name]=!0,!0)})},clean:function(t){return e(t)[0]},errors:function(){return e(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([]),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},check:function(t){t=this.validationTargetFor(this.clean(t));var n=e(t).rules(),r=!1;for(var i in n){var s={method:i,parameters:n[i]};try{var o=e.validator.methods[i].call(this,t.value.replace(/\r/g,""),t,s.parameters);if(o=="dependency-mismatch"){r=!0;continue}r=!1;if(o=="pending"){this.toHide=this.toHide.not(this.errorsFor(t));return}if(!o)return this.formatAndAdd(t,s),!1}catch(u){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+t.id+", check the '"+s.method+"' method",u),u}}if(r)return;return this.objectLength(n)&&this.successList.push(t),!0},customMetaMessage:function(t,n){if(!e.metadata)return;var r=this.settings.meta?e(t).metadata()[this.settings.meta]:e(t).metadata();return r&&r.messages&&r.messages[n]},customMessage:function(e,t){var n=this.settings.messages[e];return n&&(n.constructor==String?n:n[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(arguments[e]!==undefined)return arguments[e];return undefined},defaultMessage:function(t,n){return this.findDefined(this.customMessage(t.name,n),this.customMetaMessage(t,n),!this.settings.ignoreTitle&&t.title||undefined,e.validator.messages[n],"<strong>Warning: No message defined for "+t.name+"</strong>")},formatAndAdd:function(e,t){var n=this.defaultMessage(e,t.method),r=/\$?\{(\d+)\}/g;typeof n=="function"?n=n.call(this,t.parameters,e):r.test(n)&&(n=jQuery.format(n.replace(r,"{$1}"),t.parameters)),this.errorList.push({message:n,element:e}),this.errorMap[e.name]=n,this.submitted[e.name]=n},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){for(var e=0;this.errorList[e];e++){var t=this.errorList[e];this.settings.highlight&&this.settings.highlight.call(this,t.element,this.settings.errorClass,this.settings.validClass),this.showLabel(t.element,t.message)}this.errorList.length&&(this.toShow=this.toShow.add(this.containers));if(this.settings.success)for(var e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(var e=0,n=this.validElements();n[e];e++)this.settings.unhighlight.call(this,n[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,n){var r=this.errorsFor(t);r.length?(r.removeClass(this.settings.validClass).addClass(this.settings.errorClass),r.attr("generated")&&r.html(n)):(r=e("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(t),generated:!0}).addClass(this.settings.errorClass).html(n||""),this.settings.wrapper&&(r=r.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(r).length||(this.settings.errorPlacement?this.settings.errorPlacement(r,e(t)):r.insertAfter(t))),!n&&this.settings.success&&(r.text(""),typeof this.settings.success=="string"?r.addClass(this.settings.success):this.settings.success(r)),this.toShow=this.toShow.add(r)},errorsFor:function(t){var n=this.idOrName(t);return this.errors().filter(function(){return e(this).attr("for")==n})},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(e){return this.checkable(e)&&(e=this.findByName(e.name).not(this.settings.ignore)[0]),e},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){var n=this.currentForm;return e(document.getElementsByName(t)).map(function(e,r){return r.form==n&&r.name==t&&r||null})},getLength:function(t,n){switch(n.nodeName.toLowerCase()){case"select":return e("option:selected",n).length;case"input":if(this.checkable(n))return this.findByName(n.name).filter(":checked").length}return t.length},depend:function(e,t){return this.dependTypes[typeof e]?this.dependTypes[typeof e](e,t):!0},dependTypes:{"boolean":function(e,t){return e},string:function(t,n){return!!e(t,n.form).length},"function":function(e,t){return e(t)}},optional:function(t){return!e.validator.methods.required.call(this,e.trim(t.value),t)&&"dependency-mismatch"},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,this.pending[e.name]=!0)},stopRequest:function(t,n){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],n&&this.pendingRequest==0&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!n&&this.pendingRequest==0&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},dateDE:{dateDE:!0},number:{number:!0},numberDE:{numberDE:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,n){t.constructor==String?this.classRuleSettings[t]=n:e.extend(this.classRuleSettings,t)},classRules:function(t){var n={},r=e(t).attr("class");return r&&e.each(r.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(n,e.validator.classRuleSettings[this])}),n},attributeRules:function(t){var n={},r=e(t);for(var i in e.validator.methods){var s;i==="required"&&typeof e.fn.prop=="function"?s=r.prop(i):s=r.attr(i),s?n[i]=s:r[0].getAttribute("type")===i&&(n[i]=!0)}return n.maxlength&&/-1|2147483647|524288/.test(n.maxlength)&&delete n.maxlength,n},metadataRules:function(t){if(!e.metadata)return{};var n=e.data(t.form,"validator").settings.meta;return n?e(t).metadata()[n]:e(t).metadata()},staticRules:function(t){var n={},r=e.data(t.form,"validator");return r.settings.rules&&(n=e.validator.normalizeRule(r.settings.rules[t.name])||{}),n},normalizeRules:function(t,n){return e.each(t,function(r,i){if(i===!1){delete t[r];return}if(i.param||i.depends){var s=!0;switch(typeof i.depends){case"string":s=!!e(i.depends,n.form).length;break;case"function":s=i.depends.call(n,n)}s?t[r]=i.param!==undefined?i.param:!0:delete t[r]}}),e.each(t,function(r,i){t[r]=e.isFunction(i)?i(n):i}),e.each(["minlength","maxlength","min","max"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength","range"],function(){t[this]&&(t[this]=[Number(t[this][0]),Number(t[this][1])])}),e.validator.autoCreateRanges&&(t.min&&t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),t.minlength&&t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t.messages&&delete t.messages,t},normalizeRule:function(t){if(typeof t=="string"){var n={};e.each(t.split(/\s/),function(){n[this]=!0}),t=n}return t},addMethod:function(t,n,r){e.validator.methods[t]=n,e.validator.messages[t]=r!=undefined?r:e.validator.messages[t],n.length<3&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,n,r){if(!this.depend(r,n))return"dependency-mismatch";switch(n.nodeName.toLowerCase()){case"select":var i=e(n).val();return i&&i.length>0;case"input":if(this.checkable(n))return this.getLength(t,n)>0;default:return e.trim(t).length>0}},remote:function(t,n,r){if(this.optional(n))return"dependency-mismatch";var i=this.previousValue(n);this.settings.messages[n.name]||(this.settings.messages[n.name]={}),i.originalMessage=this.settings.messages[n.name].remote,this.settings.messages[n.name].remote=i.message,r=typeof r=="string"&&{url:r}||r;if(this.pending[n.name])return"pending";if(i.old===t)return i.valid;i.old=t;var s=this;this.startRequest(n);var o={};return o[n.name]=t,e.ajax(e.extend(!0,{url:r,mode:"abort",port:"validate"+n.name,dataType:"json",data:o,success:function(r){s.settings.messages[n.name].remote=i.originalMessage;var o=r===!0;if(o){var u=s.formSubmitted;s.prepareElement(n),s.formSubmitted=u,s.successList.push(n),s.showErrors()}else{var a={},f=r||s.defaultMessage(n,"remote");a[n.name]=i.message=e.isFunction(f)?f(t):f,s.showErrors(a)}i.valid=o,s.stopRequest(n,o)}},r)),"pending"},minlength:function(t,n,r){return this.optional(n)||this.getLength(e.trim(t),n)>=r},maxlength:function(t,n,r){return this.optional(n)||this.getLength(e.trim(t),n)<=r},rangelength:function(t,n,r){var i=this.getLength(e.trim(t),n);return this.optional(n)||i>=r[0]&&i<=r[1]},min:function(e,t,n){return this.optional(t)||e>=n},max:function(e,t,n){return this.optional(t)||e<=n},range:function(e,t,n){return this.optional(t)||e>=n[0]&&e<=n[1]},email:function(e,t){return this.optional(t)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},url:function(e,t){return this.optional(t)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(e))},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(e)},number:function(e,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},creditcard:function(e,t){if(this.optional(t))return"dependency-mismatch";if(/[^0-9 -]+/.test(e))return!1;var n=0,r=0,i=!1;e=e.replace(/\D/g,"");for(var s=e.length-1;s>=0;s--){var o=e.charAt(s),r=parseInt(o,10);i&&(r*=2)>9&&(r-=9),n+=r,i=!i}return n%10==0},accept:function(e,t,n){return n=typeof n=="string"?n.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||e.match(new RegExp(".("+n+")$","i"))},equalTo:function(t,n,r){var i=e(r).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){e(n).valid()});return t==i.val()}}}),e.format=e.validator.format}(jQuery),function(e){var t={};if(e.ajaxPrefilter)e.ajaxPrefilter(function(e,n,r){var i=e.port;e.mode=="abort"&&(t[i]&&t[i].abort(),t[i]=r)});else{var n=e.ajax;e.ajax=function(r){var i=("mode"in r?r:e.ajaxSettings).mode,s=("port"in r?r:e.ajaxSettings).port;return i=="abort"?(t[s]&&t[s].abort(),t[s]=n.apply(this,arguments)):n.apply(this,arguments)}}}(jQuery),function(e){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&e.each({focus:"focusin",blur:"focusout"},function(t,n){function r(t){return t=e.event.fix(t),t.type=n,e.event.handle.call(this,t)}e.event.special[n]={setup:function(){this.addEventListener(t,r,!0)},teardown:function(){this.removeEventListener(t,r,!0)},handler:function(t){return arguments[0]=e.event.fix(t),arguments[0].type=n,e.event.handle.apply(this,arguments)}}}),e.extend(e.fn,{validateDelegate:function(t,n,r){return this.bind(n,function(n){var i=e(n.target);if(i.is(t))return r.apply(i,arguments)})}})}(jQuery),function(e){e.fn.charCount=function(t){function r(n){var r=e(n).val().length,i=t.allowed-r;i<=t.warning&&i>=0?e(n).next().addClass(t.cssWarning):e(n).next().removeClass(t.cssWarning),i<0?e(n).next().addClass(t.cssExceeded):e(n).next().removeClass(t.cssExceeded),e(n).next().html(t.counterText+i)}var n={allowed:140,warning:25,css:"counter",counterElement:"span",cssWarning:"warning",cssExceeded:"exceeded",counterText:""},t=e.extend(n,t);this.each(function(){e(this).after("<"+t.counterElement+' class="'+t.css+'">'+t.counterText+"</"+t.counterElement+">"),r(this),e(this).keyup(function(){r(this)}),e(this).change(function(){r(this)})})}}(jQuery),parseUri.options={strictMode:!1,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},function(){Backbone.emulateHTTP=!0}.call(this),function(){good.citizen.helpers={timeAgo:function(e){var t,n,r,i,s,o,u,a,f;return n=Date.now()-Date.parse(e),i=n/6e4,r=i/60,t=r/24,u=t/7,a=t/365.25,f=a>=1?[a,"y"]:u>=1?[u,"w"]:t>=1?[t,"d"]:r>=1?[r,"h"]:(i<1?i=1:void 0,[i,"m"]),s=f[0],o=f[1],s=parseInt(s),""+s+o}}}.call(this),function(){good.citizen.socialPublisherHelper={bindFacebookTracking:function(e,t,n,r){return e.bind("click",function(){return Backbone.Mediator.publish("facebook:invite",t,n,r)})}}}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Action=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url=function(){return"/api/actions"},n.prototype.save=function(e,t){return this.id=void 0,n.__super__.save.call(this,e,t)},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Ad=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){var t;return t=e.data,this.url="/"+t.network_code+"/"+t.units,this.dimensions=t.sz.split("x").map(Number),this.targeting_keys=t.targeting_keys,this.ad_id=t.targeting_keys.id,this.defineSlot()},n.prototype.defineSlot=function(){var e=this;return googletag.cmd.push(function(){var t,n,r,i;n=googletag.defineSlot(e.url,e.dimensions,e.ad_id),i=e.targeting_keys;for(t in i)r=i[t],n.setTargeting(t,r);return n.addService(googletag.pubads())})},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Bookmark=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.bookmark=null},n.prototype.url=function(){return"/api/bookmarks"},n.prototype.save=function(e,t){return this.id=void 0,n.__super__.save.call(this,e,t)},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Contribution=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){return this.set("contributor",new good.citizen.models.User(e.contributor))},n.prototype.isAuthor=function(){return this.get("role")==="author"},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.CurrentUser=function(e){function i(){return i.__super__.constructor.apply(this,arguments)}var n,r;return t(i,e),i.prototype.url=function(){return"/api/current_user"},i.prototype.initialize=function(){this.on("change",this.syncLocal,this);if(this.loggedIn())return this.syncLocal(),this.fetch()},i.prototype.sharedSession=function(){return $.cookie("_good_shared_session")},i.prototype.logout=function(){return $.cookie("_good_shared_session","",{expires:-1}),$.cookie("_good_shared_session","",{expires:-1,path:"/",domain:".good.is"}),Backbone.Mediator.publish("user:logout"),this.trigger("logout")},i.prototype.loggedIn=function(){return this.sharedSession()!=null},i.prototype.parse=function(e){var t,n,r;if(e&&e.errors&&e.errors.identity_token){r=this.attributes;for(t in r)n=r[t],this.unset(t);this.logout()}return e},i.prototype.syncLocal=function(){var e,t,r,i,s;r={};for(i=0,s=n.length;i<s;i++)e=n[i],t="current_user_"+e,this.get(e)!=null?this.setLocal(t,this.get(e)):this.hasChanged(e)?localStorage.removeItem(t):r[e]=this.getLocal(
t);return this.set(r)},i.prototype.getLocal=function(e){var t;t=localStorage.getItem(e);switch(t){case"true":return!0;case"false":return!1;default:return t}},i.prototype.setLocal=function(e,t){if(t!=null)return localStorage.setItem(e,t)},n=["first_name","username","slug","avatar_url","admin"],r=function(){var e;try{return e="item",localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}}(),i}(good.citizen.models.User)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Follow=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Image=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Post=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.voted=!1,this.currentVote=null,this.currentVote=new good.citizen.models.Vote,this.currentVote.post=this,this.doers=new good.citizen.collections.Users,this.contributions=new good.citizen.collections.Contributions,this.tags=new good.citizen.collections.Tags},n.prototype.vote=function(){if(!this.voted)return this.voteUp()},n.prototype.voteUp=function(){return this.voted=!0,this.updateCurrentVoter(),this.currentVote.save()},n.prototype.cancelVote=function(){var e;return e=this.get("voters"),e!=null&&e.pop(),this.voted=!1,this.currentVote.destroy()},n.prototype.update=function(e){var t;e.vote_id!=null&&(this.voted=!0),this.set(e,{silent:!0}),this.voted&&this.updateCurrentVoter(),this.set("popularity",this.get("popularity")),e.todo!=null&&(t=new good.citizen.models.Todo(this,e.todo),this.set("todo",t)),e.doers!=null&&this.doers.reset(e.doers),e.number_of_doers!=null&&this.set("numberOfDoers",e.number_of_doers),e.author_todo_status!=null&&this.set("authorTodoStatus",e.author_todo_status),e.contributions!=null&&this.contributions.reset(e.contributions);if(e.tags!=null)return this.tags.reset(e.tags)},n.prototype.updateCurrentVoter=function(){var e,t=this;this.currentUserhasNotVoted=!0,e=this.get("voters"),e==null&&(e=[],this.set("voters",e)),e.map(function(e){good.citizen.currentUser.toJSON().slug===e.slug&&(t.currentUserhasNotVoted=!1)});if(!good.citizen.currentUser.isNew()&&e!=null)return e.length===window.CONFIG.limit_voters&&e.pop(),e.push(good.citizen.currentUser.toJSON())},n.prototype.todoStatus=function(){var e;return e=this.get("todo"),e!=null&&e.todoStatus!=null?e.todoStatus():"none"},n.prototype.updateTodoStatus=function(e){var t,n;t=this.todoStatus();if(this.todoStatus()!==e)switch(e){case"none":return this.get("todo")!=null&&this.get("todo").destroy(),this.set("todo",null),t==="completed"?Backbone.Mediator.publish("action:todo","Cancel Completed Do",window.location.pathname,document.title):Backbone.Mediator.publish("action:todo","Cancel To-Do",window.location.pathname,document.title),this.doers.remove(good.citizen.currentUser);case"started":return n=new good.citizen.models.Todo(this,{complete:!1}),n.save(),this.set("todo",n),this.doers.length===window.CONFIG.limit_doers&&this.doers.pop(),this.doers.add(good.citizen.currentUser),Backbone.Mediator.publish("action:todo","Add To-Do",window.location.pathname,document.title);case"completed":return this.get("todo")!=null?this.get("todo").markCompleted():(n=new good.citizen.models.Todo(this,{complete:!0}),n.save({complete:!0}),this.set("todo",n)),Backbone.Mediator.publish("action:todo","Complete Do",window.location.pathname,document.title),this.doers.length===window.CONFIG.limit_doers&&this.doers.pop(),this.doers.add(good.citizen.currentUser)}},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.SearchResult=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Tag=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.displayName=function(){return this.get("name").charAt(0).toUpperCase()+this.get("name").slice(1)},n.prototype.link=function(){return"<a href='/"+this.get("slug")+"'>"+this.displayName()+"</a>"},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Todo=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e,t){this.postSlug=e.get("slug");if(t!=null)return this.id=t.id,this.complete=t.complete,n.__super__.initialize.call(this,t)},n.prototype.urlRoot=function(){return"/api/posts/"+this.postSlug+"/todos"},n.prototype.todoStatus=function(){return this.complete?"completed":"started"},n.prototype.markCompleted=function(){return this.complete=!0,this.save({complete:this.complete})},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.User=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.idAttribute="slug",n.prototype.defaults={followers:{total_count:0},followed_tags:{total_count:0},followed_users:{total_count:0},started_todos:{total_count:0},completed_todos:{total_count:0}},n.prototype.displayName=function(){var e;return this.has("display_name")?this.get("display_name"):(e=(""+(this.get("first_name")||"")+" "+(this.get("last_name")||"")).trim(),e.length>1?e:this.get("username"))},n.prototype.greetingName=function(){return this.get("first_name")||this.get("username")},n.prototype.isAdmin=function(){return this.get("admin")},n.prototype.slug=function(){return this.get("slug")},n.prototype.avatar_url=function(){return this.get("avatar_url")},n.prototype.followersCount=function(){return this.get("followers").total_count},n.prototype.followingCount=function(){var e,t;return e=this.get("followed_tags"),t=this.get("followed_users"),t.total_count+e.total_count},n.prototype.todos_count=function(){var e,t;return t=this.get("started_todos"),e=this.get("completed_todos"),t.total_count+e.total_count},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.models.Vote=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.post=null},n.prototype.url=function(){return"/api/posts/"+this.post.get("slug")+"/vote"},n.prototype.save=function(e){var t;return t=this.post.get("popularity"),this.post.voted=!0,Backbone.Mediator.publish("post:upvote",window.location.pathname,document.title),this.post.set("popularity",t+1),this.id=void 0,n.__super__.save.call(this,e,{success:function(e,t){},error:function(e,n){return e.post.voted=!1,t=e.post.get("popularity"),e.post.set("popularity",t-1)}})},n.prototype.destroy=function(e){var t;return t=this.post.get("popularity"),this.post.voted=!1,this.post.set("popularity",t-1),this.id=!0,n.__super__.destroy.call(this,e)},n}(Backbone.Model)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.Ads=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=good.citizen.models.Ad,n.prototype.initialize=function(){},n}(Backbone.Collection)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.Contributions=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=good.citizen.models.Contribution,n.prototype.authorContribution=function(){return this.detect(function(e){return e.isAuthor()})},n.prototype.author=function(){var e;return e=this.authorContribution(),e!=null?e.get("contributor"):null},n}(Backbone.Collection)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.CurrentUsers=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="/api/current_user",n.prototype.model=good.citizen.models.User,n}(Backbone.Collection)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.Follows=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="/api/follows",n.prototype.model=good.citizen.models.Follow,n}(Backbone.Collection)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.Images=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="/api/images",n.prototype.model=good.citizen.models.Image,n}(Backbone.Collection)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.PersonalizedPosts=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="/api/posts",n.prototype.model=good.citizen.models.Post,n}(Backbone.Collection)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.Posts=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=good.citizen.models.Post,n.prototype.fetchVotes=function(e){var t,n=this;return t=_(e).map(function(e,t){return"slugs["+t+"]="+e}),$.ajax({type:"GET",dataType:"json",url:"/api/votes?limit_voters="+window.CONFIG.limit_voters+"&"+t.join("&"),success:function(e){if(e!=null)return _(e).each(function(e){var t;return t=n.findAllBySlug(e.slug),_.isEmpty(t)?n.add(e):_(t).each(function(t){return t.update(e)})})}})},n.prototype.fetchTodos=function(e){var t,n=this;return t=_(e).map(function(e,t){return"slugs["+t+"]="+e}),$.ajax({type:"GET",dataType:"json",url:"/api/todos?limit_doers="+window.CONFIG.limit_doers+"&"+t.join("&"),success:function(e){if(e!=null)return _(e).each(function(e){var t;return t=n.findAllBySlug(e.slug),_.isEmpty(t)?n.add(e):_(t).each(function(t){return t.update(e)})})}})},n.prototype.findAllBySlug=function(e){return this.filter(function(t){return t.get("slug")===e})},n}(Backbone.Collection)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.SearchResults=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.url="/api/search",n}(Backbone.Collection)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.Tags=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=good.citizen.models.Tag,n.prototype.tagList=function(){var e;if(!this.isEmpty())return e=this.map(function(e){return e.displayName()}),this.combine(e,", "," and ")},n.prototype.tagHTML=function(){var e;return this.isEmpty()?"":(e=this.map(function(e){return e.link()}),e.length>3?"<span class='tags'>in "+this.combine(e,", "," and ",3)+"</span>":"<span class='tags'>in "+this.combine(e,", "," and ")+"</span>")},n.prototype.combine=function(e,t,n,r){return r&&(e.length=r),e.length===1?_(e).first():e.length===2?_(e).first()+n+_(e).last():_(e).first()+t+this.combine(e.slice(1),t,n)},n}(Backbone.Collection)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.collections.Users=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.model=good.citizen.models.User,n}(Backbone.Collection)}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile/templates/current_user_panel_mobile"]=Haml('- if (currentUser.loggedIn() && currentUser.get(\'slug\') && currentUser.get(\'avatar_url\')) {\n%a(href="/explore" class="explore-link") Explore\n%div(class="more-links")\n  %div(class="more-links-icon")\n    %div(class="more-triangle")\n  %ul.dropdown\n    %li\n      %a(href="/members/#{currentUser.get(\'slug\')}" class="avatar")\n        %img(src="#{currentUser.get(\'avatar_url\')}" alt="#{currentUser.get(\'slug\')}")\n      %a(href="/members/#{currentUser.get(\'slug\')}" class="header-profile-link") My Profile\n    %li\n      %a(href="/everyone" class="header-everyone-link") For Everyone\n    %li\n      %a(href="/" class="header-you-link") For You\n    %li\n      %a(href="/logout" data-method="delete" class="header-logout-link") Logout\n\n- } else {\n%a(class="login" data-authenticated="register" href="/shared_users/new?mobile_site=1") Join\n%a(href="/explore" class="explore-link") Explore\n%div(class="more-links")\n  %div(class="more-links-icon")\n    %div(class="more-triangle")\n  %ul.dropdown\n    %li\n      %a(href="/session/new?mobile_site=1" class="avatar")\n        %img(src="/assets/mobile/nobody_avatar_mobile.png" alt="#{currentUser.get(\'slug\')}")\n      %a(href="/session/new?mobile_site=1" class="header-profile-link not-logged-in") Sign In\n      %span to view your profile\n    %li\n      %a(href="/everyone" class="header-everyone-link") For Everyone\n    %li\n      %a(href="/session/new?mobile_site=1") For You\n- }\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile/templates/for_you_header"]=Haml('%head\n  %title GOOD - For You\n.greeting\n  .avatar\n    %a(href="/members/#{currentUser.get(\'slug\')}")\n      %img(alt="#{currentUser.get(\'slug\')}" src="#{currentUser.avatar_url()}")\n  .tagline\n    %h1 For You\n    %h2 Latest from people and topics you follow\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["mobile/templates/post_todos_panel_mobile"]=Haml('.todo_status\n  :if this.actionButtonLabel != null\n    %div(class="icon #{this.actionButtonClass}")\n      %input(type="submit" value="#{this.actionButtonLabel}" class="action_button #{this.actionButtonClass}" data-authenticated=\'\')\n\n  :if this.numberOfDoersDescription != null\n    .number_of_doers = this.numberOfDoersDescription\n\n  :if this.primaryButtonLabel != null\n    %div(class="primary_box #{this.primaryButtonClass}")\n      %input(type="submit" value="#{this.primaryButtonLabel}" action="#{this.primaryButtonAction}" class="primary #{this.primaryButtonClass}" data-authenticated=\'\')\n\n  :if this.secondaryButtonLabel != null\n    %div(class="secondary_box #{this.secondaryButtonClass}")\n      %input(type="submit" value="#{this.secondaryButtonLabel}" action="#{this.secondaryButtonAction}" class="secondary #{this.secondaryButtonClass}" data-authenticated=\'\')\n\n  .avatars\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/_follower"]=Haml('%li\n  .avatar_and_follow_button\n    %a(href="/members/#{_.result(model, \'slug\')}")\n      %img(alt="#{_.result(model, \'displayName\')}" src="#{_.result(model, \'avatar_url\')}")\n\n    %form(action="/members/#{_.result(model, \'slug\')}/unfollow" class="user_action unfollow" data-authenticated data-follow_slug="#{_.result(model, \'slug\')}" data-follow_type="User" data-unfollowable method="post")\n      %div\n        %input(type="submit" value="Following")\n        %input(name="#{csrfParam}" type="hidden" value="#{csrfToken}")\n        %input(name="_method" type="hidden" value="delete")\n  %a(href="/members/#{_.result(model, \'slug\')}") #{_.result(model, \'displayName\')}\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/_following_tag"]=Haml("%li\n  %a(href=\"/#{_.result(model, 'displayName')}\") #{_.result(model, 'displayName')}\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/_form"]=Haml("- submission_type = (type == 'bookmark') ? 'bookmark' : 'action';\n- submission_name = (type == 'bookmark') ? 'Learn' : 'To-Do';\n- submission_type = (type == 'action') ? 'action' : 'bookmark';\n- submission_name = (type == 'action') ? 'To-Do' : 'Learn';\n\n%form{ id: \"new_#{submission_type}\" }\n  %div.submission_url\n    %label{ for: \"new_#{submission_type}_url\" } First, what's the link you're posting to #{submission_name}?\n    %input{ data-scraped-images: 'source', type: 'text', id: \"new_#{submission_type}_url\", name: \"new_#{submission_type}[url]\", placeholder: 'Paste your url here' }\n    %span\n    .spinner.url\n      .outer\n      .inner\n\n  %div\n    %label{ for: \"new_#{submission_type}_title\" } Title of your #{submission_name}\n    %input{ id: \"new_#{submission_type}_title\", name: \"#{submission_type}[title]\", type: 'text', maxlength: '110', data-warning-threshold: '50' }\n\n  %div\n    - if(submission_type == 'bookmark') {\n    %label{ for: 'new_bookmark_body' }\n      Describe your post\n      %small Providing context helps others get engaged\n    %textarea{ id: 'new_bookmark_body', name: 'bookmark[body]', cols: '40', maxlength: '500', rows: 5, data-warning-threshold: '50' }\n    - } else {\n    %label{ for: 'new_action_body' } Describe what everyone should do\n    %textarea{ id: 'new_action_body', name: 'action[body]', cols: '40', maxlength: '500', rows: 5, data-warning-threshold: '50' }\n    - }\n\n  %div\n    .caption\n      %label{ for: \"#{submission_type}_photo\" }\n        Images help your post get noticed\n        /%small Pick one or\n        /  %a{ href: '#' }> upload your own\n    .image_picker\n      %fieldset.images{ data-scraped-images: 'target' }\n    .image_upload\n      %input{ type: 'file', for: \"#{submission_type}_photo\", name: \"#{submission_type}[photo]\", id: \"#{submission_type}[photo]\" }\n      #styled_field\n        %input{ type: 'text' }\n        %input{ type: 'submit', value: 'Browse', disabled: 'disabled' }\n        %label\n          jpg, png, gif files at 210+px wide look best\n          %a{ href: '#' }\n            Delete\n\n  %div.submission_tag\n    %label{ for: \"#{submission_type}_tag_list\" }\n      Where should your post be on GOOD?\n      %small Separate your topics with a comma\n    %input{ type: 'text', name: \"#{submission_type}[tag_list]\", id: \"#{submission_type}_tag_list\", placeholder: 'ex. architecture, startups, cities' }\n    .spinner.tag\n      .outer\n      .inner\n    .spinner.submit\n      .outer\n      .inner\n\n  %input{ id: \"#{submission_type}_submit\", name: 'commit', type: 'submit', value: 'Post' }\n  %a{ class: 'simplemodal-close' } Cancel\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/_user_dash"]=Haml("#user-dash\n  .greeting\n    .avatar\n      %img(alt=\"#{_.result(this.model, 'slug')}\" src=\"#{_.result(this.model, 'avatar_url')}\")\n    .tagline\n      Hey, #{_.result(this.model, 'greetingName')}. Here's some new GOOD for you.\n    %ul.settings\n      %li.profile\n        %a(href=\"/members/#{_.result(this.model, 'slug')}\") View Profile\n      %li.manage\n        %a(href=\"/members/#{_.result(this.model, 'slug')}/manage\") Manage Account\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/_user_data_bar"]=Haml(".data-bar\n  .data\n    - if(active == 'activity') {\n    %span.activity.count\n      %label activity\n      Now\n    - } else {\n    %a(href=\"#\" class=\"activity count\")\n      %label activity\n      Now\n    - }\n\n    - if(active == 'followers') {\n    %span.followers.count\n      %label followers\n      #{_.result(model, 'followers_count')}\n    - } else {\n    %a(href=\"#\" class=\"followers count\")\n      %label followers\n      #{_.result(model, 'followers_count')}\n    - }\n\n    - if(active == 'following') {\n    %span.following.count\n      %label following\n      #{_.result(model, 'following_count')}\n    - } else {\n    %a(href=\"#\" class=\"following count\")\n      %label following\n      #{_.result(model, 'following_count')}\n    - }\n\n    - if(active == 'todos') {\n    %span.todos.count\n      %label todos\n      #{_.result(model, 'todos_count')}\n    - } else {\n    %a(href=\"#\" class=\"to-dos count\")\n      %label to-dos\n      #{_.result(model, 'todos_count')}\n    - }\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/action_form_view"]=Haml("%h2 Add a new action\n  %h3.tagline Share and promote links about good things to learn and do\n  %form#new_action\n    %p\n      %label{ for: 'action_url' } First, does your to-do have a link?\n      %input{ data-scraped-images: 'source', type: 'text_field', id: 'new_action_url', name: 'action[url]', placeholder: 'Copy and paste your url here' }\n\n    %label{ for: 'action_title' } Title of your To-Do\n    %input{ id: 'new_action_title', name: 'action[title]', type: 'text_field', maxlength: '150' }\n\n    %label{ for: 'action_body' } Describe what everyone should do\n    %textarea{ id: 'new_action_body', name: 'action[body]' }\n\n    .image_picker\n      %fieldset.images{ data-scraped-images: 'target' }\n    .caption Select thumbnail or\n      %label{ for: 'action_image' } upload your own thumbnail\n      %input{ type: 'file', for: 'action_image', name: 'action[image]', id: 'action[image]' }\n\n      %input{ type: 'text_field', name: 'action[tag_list]', id: 'action_tag_list', placeholder: 'Where should your to-do be on GOOD?', class: 'tagline' }\n\n    %input{ name: 'commit', type: 'submit'} Add it!\n    %a{ class: 'simplemodal-close' } Cancel\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/admin_edit_view"]=Haml('%a(href="/admin/posts/#{slug}/edit") Edit\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/avatar"]=Haml("%a(href=\"/members/#{_.result(this.avatarUser, 'slug')}\")\n  %img(alt=\"#{_.result(this.avatarUser, 'slug')}\" src=\"#{_.result(this.avatarUser, 'avatar_url')}\")\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/bookmark_form_view"]=Haml("%h2 Add a new bookmark\n  %h3.tagline Share and promote links about good things to learn and do\n  %form#new_bookmark\n    %p\n      %label{ for: 'new_bookmark_url' } First, does your post have a link?\n      %input{ data-scraped-images: 'source', type: 'text_field', id: 'new_bookmark_url', name: 'bookmark[url]', placeholder: 'Copy and paste your url here' }\n    %p\n      %label{ for: 'new_bookmark_title' } Title of your post\n      %input{ id: 'new_bookmark_title', type: 'text_field', name: 'bookmark[title]', maxlength: '110', placeholder: 'Insert a title', data-warning-threshold: '50'}\n    %p\n      %label{ for: 'new_bookmark_body' } Describe your post\n      %textarea{ id: 'new_bookmark_body', name: 'bookmark[body]', cols: '40', maxlength: '500', placeholder: 'Insert a description', rows: 5, data-warning-threshold: '50' }\n    .image_picker\n      %fieldset.images{ data-scraped-images: 'target' }\n    .caption Select thumbnail or\n      %label{ for: 'new_bookmark_image' } upload your own thumbnail\n      %input{ type: 'file', for: 'new_bookmark_image', name: 'bookmark[image]', id: 'bookmark[image]' }\n      %input{ type: 'text_field', name: 'bookmark[tag_list]', id: 'new_bookmark_tag_list', placeholder: 'Choose topics and separate with a comma', class: 'tagline' }\n\n    %input{ id: 'bookmark_submit', name: 'commit', type: 'submit', value: 'Post'}\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/current_user_panel"]=Haml('- if (currentUser.loggedIn() && currentUser.get(\'slug\') && currentUser.get(\'avatar_url\')) {\n%a(href="/members/#{currentUser.get(\'slug\')}" class="avatar")\n  %img(src="#{currentUser.get(\'avatar_url\')}" alt="#{currentUser.get(\'slug\')}")\n%ul.dropdown\n  %li\n    %a(href="/members/#{currentUser.get(\'slug\')}") View Profile\n  %li\n    %a(href="/members/#{currentUser.get(\'slug\')}/manage") Manage Account\n  :if currentUser.get(\'admin\')\n    %li.admin\n      %ul\n        %li\n          %a(href="/admin") Admin\n        %li\n          %a(href="http://news.good.is/goodadmin/posts") Post CMS\n        %li\n          %a(href="http://cms.good.is/newsletters") Newsletter CMS\n  %li\n    %a.logout(href="/logout" data-method="delete") Log Out\n- } else {\n%a(class="login" data-authenticated=true) Sign in\n%a(class="join" data-authenticated="register") Join\n- }\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/data_bar"]=Haml(".data\n  - if(currentFilter == 'activity') {\n  %span.activity.count\n    %label activity\n    Now\n  - } else {\n  %a(href=\"#\" class=\"activity count\")\n    %label activity\n    Now\n  - }\n\n  - if(currentFilter == 'followers') {\n  %span.followers.count\n    %label followers\n    #{currentUser.followersCount()}\n  - } else {\n  %div.followers.count\n    %label followers\n    #{currentUser.followersCount()}\n  - }\n\n  - if(currentFilter == 'following') {\n  %span.following.count\n    %label following\n    #{currentUser.followingCount()}\n  - } else {\n  %div.following.count\n    %label following\n    #{currentUser.followingCount()}\n  - }\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/delete_bookmark_view"]=Haml('%form(action="/bookmarks/#{bookmarkSlug}" class="button_to" method="post")\n  %div\n    %input(name="_method" type="hidden" value="delete")\n    %input(type="submit" value="Delete" onclick="return confirm(\'Are you sure you want to delete this post?\')")\n    %input(name="#{csrfParam}" type="hidden" value="#{csrfToken}")\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/edit_profile_view"]=Haml('%a(href="/members/#{model.get(\'slug\')}/edit" class="edit_profile") Edit profile\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/for_you"]=Haml('#user-dash\n  .greeting\n    .avatar\n      %img(alt="#{currentUser.slug()}" src="#{currentUser.avatar_url()}")\n    .tagline\n      Hey, #{currentUser.greetingName()}. Here\'s some new GOOD for you.\n\n    %ul.settings\n      %li.profile\n        %a(href="/members/#{currentUser.slug()}") View profile\n      %li.manage\n        %a(href="/members/#{currentUser.slug()}/manage") Manage account\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/for_you_header"]=Haml('%head\n  %title GOOD - For You\n.greeting\n  .avatar\n    %img(alt="#{currentUser.slug()}" src="#{currentUser.avatar_url()}")\n  .tagline\n    :if currentUser.greetingName()\n      Hey, #{currentUser.greetingName()}. Here\'s some new GOOD for you.\n\n  %ul.settings\n    %li.profile\n      %a(href="/members/#{currentUser.slug()}") View profile\n    %li.manage\n      %a(href="/members/#{currentUser.slug()}/manage") Manage account\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/hero_unit_view"]=Haml("%section Join. Share. Follow. Learn. Do.\n  %a(href='/explore') Get started now.\n  %a(href='#' class='close')\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/participant_cell"]=Haml("%img(alt=\"#{_.result(this.model, 'alt_name')}\"  title=\"#{_.result(this.model, 'alt_name')}\" src=\"#{_.result(this.model, 'avatar_url')}\")\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/post_actions_panel"]=Haml("%a(class=\"its-good\" data-authenticated='' href='#') It's GOOD\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/post_todos_invite_friends_panel"]=Haml("%div.fb_invite(id=\"#{fb_id}\")\n  %a(class='invite-friends' data-authenticated='') Invite From Facebook\n  .close\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/post_todos_panel"]=Haml('.todo_status\n  :if this.primaryButtonLabel != null\n    %div(class="primary_box icon #{this.primaryButtonClass}")\n      %input(type="submit" value="#{this.primaryButtonLabel}" class="primary #{this.primaryButtonClass}" data-authenticated=\'\')\n\n  .avatars\n\n  :if this.numberOfDoersDescription != null\n    .number_of_doers = this.numberOfDoersDescription\n\n  :if this.secondaryButtonLabel != null\n    %div(class="secondary_box icon #{this.secondaryButtonClass}")\n      %input(type="submit" value="#{this.secondaryButtonLabel}" class="secondary #{this.secondaryButtonClass}" data-authenticated=\'\')\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/search_filters"]=Haml("%a(data-filter='all' class='active') All\n%a(data-filter='posts') Posts\n%a(data-filter='topics') Topics\n%a(data-filter='users') Members\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/search_results"]=Haml(".heading\n.topics\n.members\n.posts\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/submission_form_view"]=Haml("%ul\n  %li#bookmark_tab.active\n    %a Post something to Learn\n  %li#action_tab\n    %a Post something To-Do\n\n#bookmark_submission\n#action_submission{ style: 'display: none' }\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/tagline_view"]=Haml(".tagline\n  Promote and empower what works\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/thank_you_view"]=Haml('%h1 Thanks!\n%p\n  Your\n  %a(href="/posts/#{slug}")> post\n  has been added to topic streams and your profile.\n%p Gain visibility by sending it into the wild.\n.share\n  %a.twitter(href="#{url}") Twitter\n  %a.facebook(href=\'#\') Facebook\n',{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/think_is_good"]=Haml("%span.separator â\n%strong> #{count}\n#{think_is_good}\n",{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/user_overlay_view"]=Haml("%img(src='/assets/01-welcome-overlay-kb.jpeg' usemap='#user_overlay' class='user_overlay')\n%map(name='user_overlay')\n  %area(shape='rect' coords='639, 228, 690, 282' href='#' alt='Continue' class='step_two')\n  %area(shape='rect' coords='340, 447, 360, 499' href='#' alt='Continue' class='step_two')\n  %area(shape='rect' coords='550, 447, 645, 499' href='#' alt='Continue' class='step_three')\n"
,{escapeHtmlByDefault:!0})}.call(this),function(){this.JST||(this.JST={}),this.JST["templates/vote_drawer"]=Haml("%p\n  %strong #{count}\n  #{think_is_good}\n.avatars\n",{escapeHtmlByDefault:!0})}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ApplicationViewMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="html",n.prototype.initialize=function(){return this.currentUser=good.citizen.currentUser,this.adPanel=new good.citizen.views.AdPanel,this.adPanel.render()},n.prototype.render=function(){var e;return this.timestamps=new good.citizen.views.TimestampMobile,this.currentUser.loggedIn()?(e=new good.citizen.collections.CurrentUsers,e.create({sso_session_token:this.currentUser.sharedSession()},{success:$.proxy(this.loadAllPersonalizedSections,this)}),$(".inline-signin").hide()):this.loadAllUnpersonalizedSections(),this},n.prototype.loadAllPersonalizedSections=function(e){var t,n;return this.storeReferer(),this.removeFollowButtons(e.get("slug")),this.removeFollowButtonSpinner(),t=new good.citizen.views.FeedPanelMobile,t.render(),n=new good.citizen.views.UnfollowButtonView,n.render()},n.prototype.loadAllUnpersonalizedSections=function(){var e,t;return this.addDeferredLogin(),this.storeReferer(),this.removeFollowButtonSpinner(),e=new good.citizen.views.FeedPanelMobile,e.render(),t=new good.citizen.views.TaglineView,t.render()},n.prototype.registerLoggedInState=function(){return this.$el.addClass("logged-in")},n.prototype.addDeferredLogin=function(){return this.$el.on("click","[data-authenticated]",function(e){var t;return e.preventDefault(),$(e.target).attr("data-authenticated")==="register"?t="/shared_users/new?mobile_site=1":t="/session/new?mobile_site=1",window.location=t})},n.prototype.removeFollowButtons=function(e){return this.$(".userprofile[data-slug="+e+"] .follow").remove(),this.$(".contributor[data-slug="+e+"] .follow[data-follow_slug="+e+"]").remove(),this.$("#"+e+".follow_button_spinner_container").remove()},n.prototype.removeFollowButtonSpinner=function(){return this.$(".follow_button_spinner_container").fadeOut("slow")},n.prototype.storeReferer=function(){return good.citizen.referer=window.location.href},n.prototype.infiniteScroll=function(e,t){var n,r,i,s,o;return s=1,i=!1,n=!1,o=window.location.pathname.split("/"),r=new good.citizen.views.InfiniteAdViewMobile(s),$(window).scroll(function(){var u,a=this;$(window).scrollTop()+$(window).height()>$(".main").height()&&(u=new good.citizen.views.FloatingFooter,o.indexOf("following")===-1&&o.indexOf("followers")===-1?u.render():u.render($(".page li").last().position().top-160));if(i)return;if($(window).scrollTop()+$(window).height()>$(".main").height())return t&&n===!1&&(r.render(),n=!0),i=!0,s++,$.ajax({url:e+s,type:"get",dataType:"script",beforeSend:function(){return $(".mobile_spinner").show()},complete:function(){return $(".mobile_spinner").hide()},success:function(e){var n,o;e===" "&&r.removeSecondToLastAds();if(e!==" "){i=!1,a.timestamp=new good.citizen.views.TimestampMobile,n=new good.citizen.views.FeedPanelMobile,n.render(),t&&r.renderByPage(s);if($.cookie("_good_shared_session"))return o=new good.citizen.views.UnfollowButtonView,o.render()}}})})},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.CurrentUserPanelMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.events={"click a.logout":"logout"},n.prototype.initialize=function(){return this.currentUser=good.citizen.currentUser,this.currentUser.on("change",this.render,this)},n.prototype.template=JST["mobile/templates/current_user_panel_mobile"],n.prototype.logout=function(){return this.currentUser.logout()},n.prototype.renderable=function(){return this.currentUser.loggedIn()?this.currentUser.get("slug")&&this.currentUser.get("avatar_url"):!0},n.prototype.render=function(){return this.$el.html(this.template(this)),$("html").hasClass("action-everyone")&&$(".header-everyone-link").parent().addClass("selected"),$("html").hasClass("action-index")&&$("html").hasClass("controller-posts")&&$(".header-you-link").parent().addClass("selected"),this.currentUser.loggedIn()&&this.currentUser.get("slug")&&this.endsWith(window.location.href,this.currentUser.get("slug"))&&$(".header-profile-link").parent().addClass("selected"),$(".more-links").click(function(){return $(".dropdown").toggle(),$(".overlay").toggle()}),this},n.prototype.endsWith=function(e,t){return e.indexOf(t,e.length-t.length)!==-1},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.FeedItemCellMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.actionsPanel=new good.citizen.views.PostActionsPanel({el:this.$(".actions"),model:this.model,collection:this.collection}),this.voteDrawer=new good.citizen.views.VoteDrawerMobile({el:this.$(".voters"),model:this.model}),this.todosPanel=new good.citizen.views.PostTodosPanelMobile({el:this.$(".todo_actions"),model:this.model})},n.prototype.render=function(){return this.actionsPanel.render(),this.voteDrawer.toggle(),this.todosPanel.render()},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.FeedPanelMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="body",n.prototype.initialize=function(){return this.feedItemCells=[]},n.prototype.render=function(){var e,t,n,r=this;t=new good.citizen.collections.Posts,e=".post[data-slug]:not(.js-loaded),.follow[data-slug]:not(.js-loaded),.comment[data-slug]:not(.js-loaded)",n=_.map(this.$el.find(e),function(e){var n,i,s;return $(e).addClass("js-loaded"),s=$(e).data("slug"),i=new good.citizen.models.Post({slug:s}),t.add(i),n=new good.citizen.views.FeedItemCellMobile({model:i,collection:t,el:e}),n.render(),r.feedItemCells.push(n),s}),n=_.reject(n,function(e){return e===void 0});if(!_.isEmpty(n))return t.fetchVotes(n),t.fetchTodos(n)},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ForYouHeaderMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.className="for-you-header",n.prototype.template=JST["mobile/templates/for_you_header"],n.prototype.initialize=function(){return this.currentUser=good.citizen.currentUser,this.dataBar=new good.citizen.views.DataBar},n.prototype.render=function(){return this.currentUser.loggedIn()===!0&&this.$el.html(this.template(this)),this},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ForYouMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="html",n.prototype.initialize=function(){return this.currentUser=window.good.citizen.currentUser,this.currentUser.on("change",this.render,this),this.header=new good.citizen.views.ForYouHeaderMobile,this.personalizedFeed=new good.citizen.views.PersonalizedFeedMobile,this.$el.find(".sub-header").prepend(this.header.el)},n.prototype.render=function(){return this.header.render(),this},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.InfiniteAdViewMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="#homepage_feed",n.prototype.initialize=function(e){return this.currentPage=e,this.list=this.$el.find("ul.feed")},n.prototype.render=function(){var e,t;return this.list.children().last().css("margin-bottom",0),e="Mobile_mobile_inline_ad_"+this.generateID(),t='<footer><div class="links"><a href="http://'+this.currentPath()+'?full_site=1" class="full-site-link">Visit Full Site</a></div></footer>',$(".feed-interrupt footer").remove(),$(".feed-interrupt").last().append(t),this.list.append('<div class="feed-interrupt"><div class = "ad" id ="'+e+'"></div></div>'),this.newMobileInlineAd(e)},n.prototype.currentPath=function(){return window.location.hostname.replace("m.","")+window.location.pathname},n.prototype.renderByPage=function(e){return this.currentPage=e,this.render()},n.prototype.newMobileInlineAd=function(e){var t;return t=new good.citizen.views.AdHelper({id:e,sz:"300x50",pos:"mobile_inline"+this.currentPage,units:"Mobile"}),t.render()},n.prototype.generateID=function(){return Math.floor(Math.random()*Math.pow(10,12))},n.prototype.removeSecondToLastAds=function(){var e;return e=$(".infinite_ad_container"),e.eq(e.length-1).remove()},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};good.citizen.views.PersonalizedFeedMobile=function(t){function r(){return this.paginate=e(this.paginate,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.el="#homepage_feed",r.prototype.initialize=function(){return this.collection=new good.citizen.collections.PersonalizedPosts,this.currentPage=1,this.loading=!1,this.list=null,this.render(),$(window).bind("scroll.paginate",this.paginate)},r.prototype.render=function(){if(this.loading)return;return this.loading=!0,$(".spinner").show(),this.collection.fetch({data:{scope:"personalized",page:this.currentPage},dataType:"html",success:$.proxy(this.replacePopularPostsWithPersonalizedPosts,this),error:$.proxy(this.hideSpinner,this)})},r.prototype.replacePopularPostsWithPersonalizedPosts=function(e,t){var n,r,i;return this.list?this.list.append(t):(this.$el.append(t),this.list=this.$el.find("ul.feed")),i=new good.citizen.views.InfiniteAdViewMobile(this.currentPage),$(t).is(".nothing")?($(window).unbind("scroll.paginate"),i.removeSecondToLastAds()):$(t).is(".nothing")||($(t).is(".day_one")||(r=new good.citizen.views.FloatingFooter),i=new good.citizen.views.InfiniteAdViewMobile(this.currentPage),i.render(),this.timestamps=new good.citizen.views.TimestampMobile),n=new good.citizen.views.FeedPanelMobile,n.render(),this.currentPage++,this.loading=!1,$(".spinner").hide()},r.prototype.hideSpinner=function(e,t){return $(".spinner").hide()},r.prototype.paginate=function(){var e;$(".floating_footer")&&$(window).scrollTop()>$(".floating_footer").position().top+$(".floating_footer").height()&&(e=new good.citizen.views.FloatingFooter,e.render());if($(window).scrollTop()>$(document).height()-$(window).height()-660)return this.render()},r}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.PostTodosPanelMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["mobile/templates/post_todos_panel_mobile"],n.prototype.avatarTemplate=JST["templates/avatar"],n.prototype.actionButtonLabel=null,n.prototype.actionButtonClass=null,n.prototype.primaryButtonLabel=null,n.prototype.primaryButtonClass=null,n.prototype.primaryButtonAction=null,n.prototype.secondaryButtonLabel=null,n.prototype.secondaryButtonClass=null,n.prototype.secondaryButtonAction=null,n.prototype.numberOfDoersDescription=null,n.prototype.avatarUser=null,n.prototype.authorDescription=null,n.prototype.initialize=function(e){return this.model.on("change:numberOfDoers",this.updateNumberOfDoers,this),this.model.doers.on("add remove reset",this.updateRecentDoers,this),this.model.contributions.on("add remove reset",this.updateAuthorArea,this),this.model.tags.on("add remove reset",this.updateAuthorArea,this),this.model.on("change:todo",this.changeTodoObject,this),this.doerCells=new Array,_.bindAll(this,"detectScroll"),$(window).scroll(this.detectScroll),this},n.prototype.events={"click input.action_button":"clickActionButton","click input.primary":"clickPrimaryButton","click input.secondary":"clickSecondaryButton"},n.prototype.render=function(){var e,t,r=this;return n.__super__.render.call(this),t=this.$el.find(".avatars"),t.empty(),_(this.doerCells).each(function(e){return t.append(e.render().el)}),this.authorDescription!=null&&(e=this.$el.parentsUntil("li","article").find(".authorship"),e.find(".authors").html(this.authorDescription),e.find(".avatars").html(this.avatarTemplate())),this},n.prototype.changeTodoObject=function(){return this.todo!=null&&this.todo.off!=null&&this.todo.off(),this.todo=this.model.get("todo"),this.todo!=null&&this.todo.on!=null&&this.todo.on("change",this.updateTodoButtons,this),this.updateTodoButtons(),this.updateNumberOfDoers(),this.updateAuthorArea()},n.prototype.updateTodoButtons=function(){switch(this.model.todoStatus()){case"none":this.skinActionButton("Do it","doit"),this.skinPrimaryButton("Add to-do","todo","todo"),this.skinSecondaryButton("Mark as Done","done","done");break;case"started":this.skinActionButton("To Do","todo"),this.skinPrimaryButton("Cancel to-do","cancel","cancel"),this.skinSecondaryButton("Mark as Done","done","done");break;case"completed":this.skinActionButton("Done","done"),this.skinPrimaryButton("Remove to-do","cancel","cancel"),this.skinSecondaryButton("Keep as Done","done","ignore")}return this.updateAuthorArea()},n.prototype.updateNumberOfDoers=function(){var e;return e=this.model.get("numberOfDoers"),this.numberOfDoersDescription=function(){switch(e){case 0:return this.model.todoStatus()!=="none"?"You're in":"Save this or mark as Done.";case 1:return"1 other is in";default:return""+e+" others are in"}}.call(this),this.render(),this.model.todoStatus()!=="none"&&(e+=1),$(".todo_count").html(e)},n.prototype.updateRecentDoers=function(){var e=this;return this.doerCells=this.model.doers.map(function(e){return new good.citizen.views.ParticipantCell({model:e})}),this.render()},n.prototype.updateAuthorArea=function(){var e;e=this.ownerUser();if(e!=null)return this.updateAuthorDescription(e),e!=null&&e.slug()!==good.citizen.currentUser.slug()?this.avatarUser=e:this.model.todoStatus()==="none"?this.avatarUser=this.model.contributions.author():this.avatarUser=good.citizen.currentUser},n.prototype.ownerUser=function(){var e;return e=this.$el.parents("ul.feed","ul.feed"),e.data("owner_slug")!=null?new good.citizen.models.User({slug:e.data("owner_slug"),display_name:e.data("owner_name"),avatar_url:e.data("owner_avatar")}):null},n.prototype.ownerTodoStatus=function(){return this.$el.parents("ul.feed","ul.feed").data("todo_status")||"none"},n.prototype.updateAuthorDescription=function(e){return e.slug()!==good.citizen.currentUser.slug()?this.authorDescription=function(){switch(this.ownerTodoStatus()){case"started":return""+e.displayName()+" wants to do this";case"completed":return""+e.displayName()+" did this";default:return this.authorTodoActivity()||"Something to do"}}.call(this):this.authorDescription=function(){switch(this.model.todoStatus()){case"started":return"You want to do this";case"completed":return"You did this";default:return this.authorTodoActivity()||"Something to do"}}.call(this),this.model.tags.isEmpty()||(this.authorDescription+=" "+this.model.tags.tagHTML()),this.render()},n.prototype.authorTodoActivity=function(){var e;e=this.model.contributions.author();if(e!=null)switch(this.model.get("authorTodoStatus")){case"started":return""+e.displayName()+" wants to do this";case"completed":return""+e.displayName()+" did this";default:return""+e.displayName()+" shared something to do"}},n.prototype.skinActionButton=function(e,t){return this.actionButtonLabel=e,this.actionButtonClass=t},n.prototype.skinPrimaryButton=function(e,t,n){return this.primaryButtonLabel=e,this.primaryButtonClass=t,this.primaryButtonAction=n},n.prototype.skinSecondaryButton=function(e,t,n){return this.secondaryButtonLabel=e,this.secondaryButtonClass=t,this.secondaryButtonAction=n},n.prototype.primaryButton=function(){return this.$el.find("input.primary")},n.prototype.primaryBox=function(){return this.$el.find(".primary_box")},n.prototype.secondaryButton=function(){return this.$el.find("input.secondary")},n.prototype.secondaryBox=function(){return this.$el.find(".secondary_box")},n.prototype.clickActionButton=function(e){return this.primaryBox().slideToggle(),this.secondaryBox().slideToggle()},n.prototype.clickPrimaryButton=function(){if(good.citizen.currentUser.loggedIn())return this.changeTodo(this.primaryButton().attr("action"))},n.prototype.clickSecondaryButton=function(){if(good.citizen.currentUser.loggedIn())return this.changeTodo(this.secondaryButton().attr("action"))},n.prototype.changeTodo=function(e){var t;t=this.model.todoStatus();switch(e){case"todo":if(t!=="started")return this.model.updateTodoStatus("started");break;case"done":if(t!=="completed")return t==="started"?(this.model.updateTodoStatus("none"),this.model.updateTodoStatus("completed")):this.model.updateTodoStatus("completed");break;case"cancel":if(t!=="none")return this.model.updateTodoStatus("none");break;case"ignore":return this.primaryBox().slideUp(),this.secondaryBox().slideUp()}},n.prototype.detectScroll=function(){return this.primaryBox().slideUp(),this.secondaryBox().slideUp()},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.TimestampMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){return $("time_mobile").each(function(){var e,t;return t=$(this),e=t.attr("datetime"),t.html(good.citizen.helpers.timeAgo(e)+" ago")})},n}(Backbone.View)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.VoteDrawerMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["templates/vote_drawer"],n.prototype.initialize=function(){return this.model.on("change:popularity",this.toggle,this)},n.prototype.toggle=function(){var e,t,n=this;return e=this.model.get("popularity")||0,t=e===1,this.count=""+e,e===0?(this.count="",this.think_is_good="Be the first to vote."):this.think_is_good=" "+(t?"thinks":"think")+" it's good",$(".vote_count").html(e),this.render(),this.model.has("voters")&&_(this.model.get("voters")).each(function(e){var t;return t=new good.citizen.views.ParticipantCell({model:e}),n.$el.find(".avatars").append(t.render().el)}),this},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.Ad=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.div_id=this.model.targeting_keys.id},n.prototype.render=function(){var e=this;return googletag.cmd.push(function(){return googletag.display(e.div_id)})},n}(Backbone.View)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.AdHelper=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){return this.ad_data={creative_type:"adi",network_code:"6709",sz:e.sz,targeting_keys:{id:e.id,pos:e.pos},type:"dart",units:e.units},this.ad=new good.citizen.models.Ad({data:this.ad_data})},n.prototype.render=function(){var e;return e=new good.citizen.views.Ad({model:this.ad}),e.render(),googletag.cmd.push(function(){return googletag.enableServices()})},n}(Backbone.View)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.AdPanel=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="body",n.prototype.initialize=function(){var e,t,n,r;return window.googletag=window.googletag||{},googletag.cmd=googletag.cmd||[],e=document.createElement("script"),e.async=!0,e.type="text/javascript",r="https:"===document.location.protocol,t=r?"https:":"http:",e.src=t+"//www.googletagservices.com/tag/js/gpt.js",n=document.getElementsByTagName("script")[0],n.parentNode.insertBefore(e,n),this.adItemCells=[],this.data=good.citizen.ads},n.prototype.render=function(){var e,t,n,r,i,s,o;if(this.data){good.citizen.ad_collection=new good.citizen.collections.Ads,googletag.cmd.push(function(){return googletag.pubads().collapseEmptyDivs(),googletag.enableServices()}),s=this.data,o=[];for(r=0,i=s.length;r<i;r++)n=s[r],e=new good.citizen.models.Ad({data:n}),good.citizen.ad_collection.add(e),t=new good.citizen.views.Ad({model:e,collection:good.citizen.ad_collection}),t.render(),o.push(this.adItemCells.push(t));return o}},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.AdminEditView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="#admin_edit_js",n.prototype.template=JST["templates/admin_edit_view"],n.prototype.initialize=function(){return this.slug=$(".post[data-slug]").data("slug")},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ApplicationView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="html",n.prototype.initialize=function(){return this.adPanel=new good.citizen.views.AdPanel,this.adPanel.render(),this.currentUser=good.citizen.currentUser,this.currentUser.get("invitation_hashed_id")!=null?this.storeInvitationUrl(this.currentUser.get("invitation_hashed_id")):this.storeInvitationUrl(),typeof FB!="undefined"&&FB!==null&&this.initializeFacebook(),this.mixpanelView=new good.citizen.views.MixpanelView,this.publishPageView(),this.publishFacebookInvite(),good.citizen.PublisherView=new good.citizen.views.ClickPublisherView},n.prototype.initializeFacebook=function(){return FB.init({appId:good.citizen.facebookAppId,xfbml:!0,cookie:!0}),new good.citizen.views.FacebookFriendsView({el:$(".facebook-friends-view")}),new good.citizen.views.FacebookFriendsView({el:$(".you")})},n.prototype.render=function(){var e;return this.currentUser.loggedIn()?(e=new good.citizen.collections.CurrentUsers,e.create({sso_session_token:this.currentUser.sharedSession()},{success:$.proxy(this.loadAllPersonalizedSections,this)})):this.loadAllUnpersonalizedSections(),this},n.prototype.loadAllPersonalizedSections=function(e){var t,n,r,i,s,o,u;return this.storeReferer(),this.storeInvitationUrl(e.get("invitation_hashed_id")),i=new good.citizen.views.EditProfileView({model:e}),i.render(),this.displayHeroUnit(),this.addSubmissionModal(),this.addRegistrationModalBox(),this.addForgotPassword(),this.removeFollowButtons(e.get("slug")),this.updateNoFollowersCopy(e.get("slug")),this.updateNoFollowingCopy(e.get("slug")),this.updateNoActivitiesCopy(e.get("slug")),this.updateNoTodosCopy(e.get("slug")),u=new good.citizen.views.UnfollowButtonView,u.render(),s=new good.citizen.views.FeedPanel,s.render(),o=new good.citizen.views.StickyCarouselView,o.render(),this.registerLoggedInState(),this.renameTopContributorsHeader(),this.hideLeftSidebarSponsor(),this.renameUserProfileHeaders(e.get("slug")),e.isAdmin()&&(r=new good.citizen.views.EditPost,n=new good.citizen.views.DeleteBookmarkView,n.render(),t=new good.citizen.views.AdminEditView,t.render()),$.cookie("hide_user_overlay",!0,{expires:1e4}),this.hideExploreJoinButton(),this.expandSearchTextArea(),this.showFollowingConfirmation(),this.showRandomExploreUsers(),this.showRandomExploreTopics(),this.clearInvitationCookies(),this.bindNoticeMessageDisplay(),this.bindNoticeMessageClose(),this.bindEditProfileSpinner(),this.bindSaveProfileSpinner(),this.removeFollowButtonSpinner(),this.setFeaturedActionTitleFontSize(),this.displayFloatingFooter(),this.setUserSuperProperties()},n.prototype.loadAllUnpersonalizedSections=function(){var e,t,n;this.storeReferer(),this.addRegistrationModalBox(),this.addAutoFollowingCookie(),this.addDeferredLogin(),this.displayHeroUnit(),e=new good.citizen.views.FeedPanel,e.render(),n=new good.citizen.views.TaglineView,n.render(),t=new good.citizen.views.StickyCarouselView,t.render(),this.bindContributorPromptClose(),this.bindFollowLinkToFollowButton(),this.detectSignInUrlHash(),this.showRandomExploreUsers(),this.showRandomExploreTopics(),this.logInInvitedUsers(),this.removeFollowButtonSpinner(),this.setFeaturedActionTitleFontSize(),this.displayFloatingFooter(),this.showFollowDetailBox();switch(this.hash()){case"#join":return this.showRegistrationModal();case"#signin":return this.showLoginModal();default:return(new good.citizen.views.WelcomeModal).render()}},n.prototype.showFollowDetailBox=function(){if(!$.cookie("hide_follow_CTA"))return this.$("#contributor_follow_prompt").fadeIn("slow")},n.prototype.hash=function(){return window.location.hash},n.prototype.storeInvitationUrl=function(e){var t,n;return t=parseUri(window.location.href),n=""+t.protocol+"://"+t.authority,e!=null&&(n=""+n+"/invitations/"+e),good.citizen.invitationUrl=n},n.prototype.removeFollowButtons=function(e){return this.$(".userprofile[data-slug="+e+"] .follow").remove(),this.$(".contributor[data-slug="+e+"] .follow[data-follow_slug="+e+"]").remove(),this.$("#"+e+".follow_button_spinner_container").remove()},n.prototype.removeFollowButtonSpinner=function(){return this.$(".follow_button_spinner_container").fadeOut("slow")},n.prototype.updateNoFollowersCopy=function(e){return this.$("#user-feed[data-slug="+e+"] .day_one.followers p").html("Get involved!"),this.$("#user-feed[data-slug="+e+"] .day_one.followers p + p").html("Start following, joining discussions, and posting to gain followers.")},n.prototype.updateNoFollowingCopy=function(e){return this.$("#user-feed[data-slug="+e+"] .day_one.following p").html("Not much to see here!"),this.$("#user-feed[data-slug="+e+"] .day_one.following p + p").html('Click <a href="/explore">here</a> to explore topics and members to follow.')},n.prototype.updateNoActivitiesCopy=function(e){return this.$("#user-feeds[data-slug="+e+"] .day_one p").html("You have not been that busy on GOOD"),this.$("#user-feeds[data-slug="+e+"] .day_one p + p").html('Check out our <a href="/explore">Explore page</a> to get started.')},n.prototype.updateNoTodosCopy=function(e){return this.$("#user-feed[data-slug="+e+"] .no_todos p").html('Start building your to-do list by checking out the featured to-do on the <a href="/">homepage</a>.')},n.prototype.registerLoggedInState=function(){return this.$el.addClass("logged-in")},n.prototype.renameTopContributorsHeader=function(){return this.$(".suggested_people h3").text("Who to Follow")},n.prototype.hideLeftSidebarSponsor=function(){return this.$(".left-sidebar .sponsor").hide()},n.prototype.renameUserProfileHeaders=function(e){return this.$(".profilepage[data-slug="+e+"]").find(".followers h3").text("Following you").end().find(".following h3").text("You are following")},n.prototype.storeReferer=function(){return good.citizen.referer=window.location.href},n.prototype.addRegistrationModalBox=function(){var e;return e=new good.citizen.views.RegistrationModalBoxView,this.$el.append(e.render().el)},n.prototype.addSubmissionModal=function(){var e;return e=new good.citizen.views.SubmissionModalView,e.render()},n.prototype.bindEditProfileSpinner=function(){return $("#edit_profile_js .edit_profile").bind("click",function(){return $("#edit_profile_spinner").show()})},n.prototype.bindSaveProfileSpinner=function(){return $("#edit_user.edit_user").bind("submit",function(){return $("#edit_profile_spinner").show()})},n.prototype.displayHeroUnit=function(){var e;if(!$.cookie("hide_explore_top"))return e=new good.citizen.views.HeroUnitView,e.render()},n.prototype.bindContributorPromptClose=function(){return $("#contributor_follow_prompt .close").bind("click",function(e){return $("#contributor_follow_prompt").fadeOut(),$.cookie("hide_follow_CTA",!0,{expires:1e4}),e.preventDefault()})},n.prototype.bindFollowLinkToFollowButton=function(){return $("#contributor-follow-prompt-link").bind("click",function(e){return e.preventDefault(),$(".contributor_follow_button").click()})},n.prototype.bindNoticeMessageDisplay=function(){if($("#notice-message").text()!==null&&$("#notice-message").text()!=="")return $("#notice-message-wrapper").fadeIn("fast"),setTimeout(function(){return $("#notice-message-wrapper").fadeOut()},3e3)},n.prototype.bindNoticeMessageClose=function(){return $("#notice-message").bind("click",function(){return $("#notice-message-wrapper").fadeOut()})},n.prototype.detectSignInUrlHash=function(){var e,t;e=window.location.hash;if(e==="#signin")return t=""+good.citizen.RegistrationServer+"/session/new.js",$.getScript(t)},n.prototype.setFeaturedActionTitleFontSize=function(){var e,t;t=37,e=$(".featured-action h2");if(e.height()>t*3)return e.addClass("shift-2");if(e.height()>t*2)return e.addClass("shift-1")},n.prototype.addAutoFollowingCookie=function(){var e=this;return this.$el.on("click",'[data-follow_slug][data-authenticated][data-follow_type="User"]',function(e){return e.preventDefault(),$.cookie("user_to_follow",$(e.target).closest("form").attr("data-follow_slug"),{path:"/"})})},n.prototype.addDeferredLogin=function(){var e=this;return this.$el.on("click","[data-authenticated]",function(t){return t.preventDefault(),$(t.target).attr("data-authenticated")==="register"?e.showRegistrationModal():e.showLoginModal()})},n.prototype.showFollowingConfirmation=function(){if($.cookie("show_following_confirmation")==="true")return this.$("#notice-message").html("Following</br>You have successfully added to your following list."),$.cookie("show_following_confirmation",null,{domain:".good.is",path:"/"})},n.prototype.showRegistrationModal=function(){return $.getScript(""+good.citizen.RegistrationServer+"/shared_users/new.js")},n.prototype.showLoginModal=function(){return $.getScript(""+good.citizen.RegistrationServer+"/session/new.js")},n.prototype.addForgotPassword=function(){return this.$el.on("click","[data-forgot-password]",function(e){return e.preventDefault(),$.getScript(""+good.citizen.RegistrationServer+"/shared_users/forgot_password.js")})},n.prototype.showRandomExplore=function(e,t){var n;return Array.prototype.shuffle=function(){return this.sort(function(){return.5-Math.random()})},n=$.makeArray($(""+e+" li:not(.you):not(.yourboard)")).shuffle(),$(n.slice(t-n.length,n.length)).hide(),$(n.slice(0,t)).show(),$(""+e+" li.you").show(),$(""+e+" li.yourboard").show()},n.prototype.showRandomExploreUsers=function(){return this.showRandomExplore("#members",8)},n.prototype
.showRandomExploreTopics=function(){return this.showRandomExplore("#topics",8)},n.prototype.hideExploreJoinButton=function(){return $("#explore .join").hide()},n.prototype.expandSearchTextArea=function(){return $(".search #q").css("width","805px"),$(".search #search_error").css("width",$(".search #q").width())},n.prototype.logInInvitedUsers=function(){if($.cookie("inviter_slug"))return $.getScript(""+good.citizen.RegistrationServer+"/shared_users/new.js"),!1},n.prototype.clearInvitationCookies=function(){return $.cookie("inviter_slug",null),$.cookie("inviter_display_name",null)},n.prototype.displayFloatingFooter=function(){var e,t,n,r,i,s,o;r=window.location.pathname,n=r.split("/"),o=["about","posts","following","followers"];for(i=0,s=o.length;i<s;i++){t=o[i];if(n.indexOf(t)!==-1)return}if(r!=="/"&&$("li.feed-item").length>=12)return e=new good.citizen.views.FloatingFooter,e.render()},n.prototype.publishPageView=function(){var e,t;return e=document.title,t=window.location.pathname,Backbone.Mediator.publish("track:pageview",e,t)},n.prototype.setUserSuperProperties=function(){var e;return this.currentUser.get("avatar_url")===void 0?e="":e=this.currentUser.get("avatar_url"),Backbone.Mediator.publish("user:super",this.currentUser.get("username"),this.currentUser.get("alt_name"),this.currentUser.get("email"),this.currentUser.get("slug"),e)},n.prototype.publishFacebookInvite=function(){var e,t;return e=document.title,t=window.location.pathname,good.citizen.socialPublisherHelper.bindFacebookTracking(this.$(".right-sidebar #facebook-friends-view .invite-friends"),"general",e,t)},n.prototype.infiniteScroll=function(e,t,n){var r,i,s,o,u;return o=1,s=!1,r=!1,u=window.location.pathname.split("/"),i=new good.citizen.views.InfiniteAdView(o),$(window).scroll(function(){var a,f=this;$(window).scrollTop()>$(".floating_footer").position().top+$(".floating_footer").height()&&(a=new good.citizen.views.FloatingFooter,u.indexOf("following")===-1&&u.indexOf("followers")===-1?a.render():a.render($(".page li").last().position().top-160));if(s)return;n&&r===!1&&(i.render(),r=!0);if($(window).scrollTop()>$(document).height()-$(window).height()-660)return s=!0,o++,$(".feed").children().last().css("margin-bottom",0),this.$(".follow_button_spinner_container").fadeOut("slow"),$.ajax({url:e+o,type:"get",dataType:"script",beforeSend:function(){return $(".spinner").show()},complete:function(){return $(".spinner").hide()},success:function(e){var r,u;e===" "&&i.removeSecondToLastAds();if(e!==" "){s=!1,f.timestamp=new good.citizen.views.Timestamp,t&&(r=new good.citizen.views.FeedPanel,r.render()),$.cookie("_good_shared_session")&&(u=new good.citizen.views.UnfollowButtonView,u.render());if(n)return i.renderByPage(o)}}})})},n}(good.citizen.views.BaseView)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};good.citizen.views.AutocompleteSearchView=function(t){function r(){return this.hideSearchForm=e(this.hideSearchForm,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.initialize=function(e,t){var n=this;return this.routePrefix=this.$el.data("search-route"),this.searchSuggestionsUrl="/api/search/suggestions",this.$parent=this.$el.parent(),this.bindClearSearchInput(),this.bindShowSearchForm(),this.bindHideSearchForm(),$("#q-overlay").length===0&&($("body").append('<div id="q-overlay"></div>'),$("body").append('<div id="h-overlay"></div>')),this.$el.autocomplete({appendTo:this.$parent,source:function(e,t){return $.getJSON(n.searchSuggestionsUrl,{q:e.term},function(e){var r,i;return i=_.first(e,10),r=_.map(i,function(e){return{label:e.term,value:e.term}}),t(r),mixpanel.people.increment("Searches"),mixpanel.track("Site search"),n.toggleErrorMessage(e)})},select:function(e,t){var r,i;return e.preventDefault(),r=t.item.value,i=""+n.routePrefix+"?q="+r,n.redirect(i)},autoSelect:!1,showPrompts:!1}),$.extend(!0,this.$el.data("autocomplete").options,t)},r.prototype.bindClearSearchInput=function(){var e=this;return this.$el.bind("keyup",function(){if(e.$el.val().length===0)return e.hideSearchError()})},r.prototype.bindShowSearchForm=function(){var e=this;return this.$parent.find("button").bind("click",function(t){return t.preventDefault(),e.showSearchForm()})},r.prototype.bindGetSearch=function(){var e=this;return this.$parent.find("button").bind("click",function(t){return t.preventDefault(),e.getSearch()})},r.prototype.toggleErrorMessage=function(e){return e.length===0?this.showSearchError():this.hideSearchError()},r.prototype.showSearchError=function(){return this.$parent.find("#search_error").show(),this.$parent.find(".aid").show(),this.$parent.find(".ui-menu").show()},r.prototype.hideSearchError=function(){return this.$parent.find("#search_error").hide()},r.prototype.bindHideSearchForm=function(){var e=this;return $(document).keyup(function(t){if(t.keyCode===27)return e.hideSearchForm()}),$(document).delegate("#q-overlay","click",function(){return e.hideSearchForm()}),$(document).delegate("#h-overlay","click",function(){return e.hideSearchForm()})},r.prototype.showSearchForm=function(){return this.$parent.removeClass("collapsed").addClass("expanded"),this.$el.show().focus(),$("ul.filters").hide(),$("#q-overlay").fadeIn(),$("#h-overlay").fadeIn(),$(".search button").unbind("click"),this.bindGetSearch()},r.prototype.hideSearchForm=function(){return this.$parent.addClass("collapsed").removeClass("expanded"),$("ul.filters").show(),this.$el.hide(),this.hideSearchError(),this.$parent.find(".aid").hide(),this.$parent.find(".ui-menu").hide(),$("#q-overlay").fadeOut(),$("#h-overlay").fadeOut(),this.$parent.find("button").unbind("click"),this.bindShowSearchForm()},r.prototype.getSearch=function(){var e,t;t=this.$el.val().toLowerCase();if(t.length!==0)return e=""+this.routePrefix+"?q="+t,this.redirect(e)},r.prototype.redirect=function(e){return mixpanel.track("Successful Search"),this.hideSearchError(),setTimeout(function(){return window.location.href=e},300)},r}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.AutocompleteTagsView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){var e,t;return e=this.$el.parent(),t=function(e){return e.split(/,\s*/)},this.$el.autocomplete({appendTo:e,open:function(){return e.find(".ui-menu").css({left:0,width:"422px",clear:"both"})},source:function(e,n){var r;return r=t(e.term).pop(),$.ajax({url:"/api/tags",dataType:"json",data:{q:r},beforeSend:function(){return $(".spinner.tag").show()},complete:function(){return $(".spinner.tag").hide()},success:function(e){var t;return t=_(e.slice(0,3)).pluck("name"),n(t)}})},select:function(e,n){var r;return r=t(this.value),r.pop(),r.push(n.item.value),r.push(""),this.value=r.join(", "),!1},focus:function(){return!1},autoSelect:!0,showPrompts:!0})},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.BaseView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.render=function(){return _(this).result("renderable")&&this.$el.html(this.template(this)),this},n.prototype.renderable=!0,n}(Backbone.View)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.CharacterCounterView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.events={keyup:"updateCounter"},n.prototype.initialize=function(){return this.input=$(this.el),this.counter=$('<div class="counter" style="display:inline"/>'),this.max=this.input.attr("maxlength"),this.threshold=this.input.data("warning-threshold"),this.render()},n.prototype.render=function(){return this.input.after(this.counter)},n.prototype.updateCounter=function(){var e;e=this.max-this.input.val().length;if(!(e<=this.threshold))return this.counter.hide(),this.counter.removeClass("warning full");this.counter.html(e),this.counter.show(),e===0&&this.counter.addClass("full");if(e>0)return this.counter.addClass("warning")},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ClickPublisherView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="html",n.prototype.initialize=function(){var e=this;return mixpanel.track_links(".homepage h3 a","Clicked Carousel",function(){return e.parameters("post title")}),mixpanel.track_links(".homepage a.image","Clicked Carousel",function(){return e.parameters("post image")}),mixpanel.track_links(".sticky_tags li a","Clicked Carousel",function(){return e.parameters("topic tab")}),mixpanel.track_links(".homepage .authorship .authors .tags a","Clicked Carousel",function(){return e.parameters("topic")}),mixpanel.track_links(".homepage .authorship .authors a.contributor","Clicked Carousel",function(){return e.parameters("contributor")}),mixpanel.track_links(".topic h3 a","Clicked Featured Topic Post",function(){return e.topicParams("post title")}),mixpanel.track_links(".topic a.image","Clicked Featured Topic Post",function(){return e.topicParams("post image")}),mixpanel.track_links(".topic .authorship .authors .tags a","Clicked Featured Topic Post",function(){return e.topicParams("topic")}),mixpanel.track_links(".topic .authorship .authors a.contributor","Clicked Featured Topic Post",function(){return e.topicParams("contributor")}),mixpanel.track_links(".featured-action h2 a","Clicked Featured Do",function(){return e.doParams("post title")}),mixpanel.track_links(".featured-action a.image","Clicked Featured Do",function(){return e.doParams("post image")}),this.$(".left-sidebar .share .twitter").bind("click",function(){return Backbone.Mediator.publish("share:content","Twitter","Post")}),this.$(".left-sidebar .share .facebook").bind("click",function(){return Backbone.Mediator.publish("share:content","Facebook","Post")})},n.prototype.events=function(){return{"click .carousel nav a.next":"trackStickyNavNextClick","click .carousel nav a.back":"trackStickyNavBackClick"}},n.prototype.trackStickyNavNextClick=function(){return Backbone.Mediator.publish("carousel:arrow",this.parameters("right arrow"))},n.prototype.trackStickyNavBackClick=function(){return Backbone.Mediator.publish("carousel:arrow",this.parameters("left arrow"))},n.prototype.parameters=function(e){var t,n;return t={},n=window.location.pathname,t["page url"]=n,t["tab position"]=this.findTabPosition(),t["source page type"]=this.determinePageType(n),t["page name"]=document.title,t["click target"]=e,t},n.prototype.topicParams=function(e){var t;return t={},t["page name"]=document.title,t["page url"]=window.location.pathname,t["click target"]=e,t},n.prototype.doParams=function(e){var t,n;return t={},n=window.location.pathname,t["source page type"]=this.determinePageType(n),t["page name"]=document.title,t["page url"]=n,t["click target"]=e,t},n.prototype.determinePageType=function(e){var t,n;t=e.split("/")[1];switch(t){case"everyone":return n="For Everyone";case"":return n="For You";default:return n="Topic"}},n.prototype.findTabPosition=function(){var e,t;return t=$("ul.sticky_tags li").children(),e=$("ul.sticky_tags").find(".active"),t.index(e)+1},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.CurrentUserPanel=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.events={"click a.logout":"logout"},n.prototype.initialize=function(){return this.currentUser=good.citizen.currentUser,this.currentUser.on("change",this.render,this)},n.prototype.template=JST["templates/current_user_panel"],n.prototype.logout=function(){return this.currentUser.logout()},n.prototype.renderable=function(){return this.currentUser.loggedIn()?this.currentUser.get("slug")&&this.currentUser.get("avatar_url"):!0},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.DataBar=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.className="data-bar",n.prototype.template=JST["templates/data_bar"],n.prototype.initialize=function(){return this.currentUser=good.citizen.currentUser,this.currentFilter=this.options.currentFilter||"activity"},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.DeleteBookmarkView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="#delete_bookmark_js",n.prototype.template=JST["templates/delete_bookmark_view"],n.prototype.initialize=function(){return this.bookmarkSlug=$(".post[data-slug]").data("slug"),this.csrfParam=$('meta[name="csrf-param"]').attr("content"),this.csrfToken=$('meta[name="csrf-token"]').attr("content")},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.EditPost=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el=".edit_post",n.prototype.events={"change #admins":"addContributor","click  .delete":"removeContributor"},n.prototype.initialize=function(){return this.formValidation()},n.prototype.addContributor=function(e){var t,n,r;n=this.$(e.target).find(":selected"),t=n.text(),r=n.val();if(this.checkAuthor(e,r))return this.$(".contributor_list").append("<li>"+t+" - <a href='#' class='delete'>remove</a>         <input name='post[contributors][]' type='hidden' value='"+r+"'/></li>")},n.prototype.checkAuthor=function(e,t){var n,r;return r=[],n=this.$(".contributor_list input[type=hidden]"),this.$(e.target).prop("selectedIndex",0),$.map(n,function(e,t){return r.push($(e).attr("value"))}),$.inArray(t,r)<0},n.prototype.removeContributor=function(e){return e.preventDefault(),this.$(e.target).parent().remove()},n.prototype.formValidation=function(){var e=this;return this.$el.validate({validClass:"valid",errorClass:"invalid",onkeyup:!1,onclick:!1,rules:{"post[title]":{required:!0},"post[url]":{remote:{url:"/api/bookmarks/url_check",data:{url:function(){return this.$("#post_url").val()}},async:!0,dataFilter:function(e){var t;return t=JSON.parse(e),t.errors.hasOwnProperty("url")?"false":"true"}}},"post[tag_list]":{required:!0},"post[contributors][]":{required:!0}},messages:{"post[title]":{required:"Title required"},"post[tag_list]":{required:"One topic required"},"post[contributors][]":{required:"One contributor required"}},errorPlacement:function(e,t){return t.before(e)}})},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.EditProfileView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["templates/edit_profile_view"],n.prototype.initialize=function(){return this.setElement($(".userprofile[data-slug="+this.model.get("slug")+"] #edit_profile_js")),$("#user_introduction").charCount({allowed:70}),$("#user_skills").charCount({allowed:100})},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.FacebookFriendsView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){var t,n;this.name="Join me on the new good.is",this.description="GOOD is a community of people who give a damn. Follow people and orgs you respect, and the issues you care about. Discover, share and promote good things to learn and do. Itâs getting awesome in here.",this.link=good.citizen.invitationUrl,e.name!=null&&(this.name=e.name),e.description!=null&&e.description!==null&&(this.description=e.description);if(e.link!=null)return t=parseUri(window.location.href),n=""+t.protocol+"://"+t.authority,this.link=""+n+e.link},n.prototype.events={"click .invite-friends":"createInvitation"},n.prototype.createInvitation=function(){if(!good.citizen.currentUser.isNew())return FB.ui({method:"send",name:this.name,description:this.description,picture:this.invitationImage,link:this.link})},n.prototype.invitationImage="http://resource.good.is.s3.amazonaws.com/calumet/invite-logo.png",n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.FeedItemCell=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.actionsPanel=new good.citizen.views.PostActionsPanel({el:this.$(".actions"),model:this.model,collection:this.collection}),this.voteDrawer=new good.citizen.views.VoteDrawer({el:this.$(".voters"),model:this.model}),this.thinkIsGood=new good.citizen.views.ThinkIsGood({el:this.$(".think_is_good_js"),model:this.model}),this.todosPanel=new good.citizen.views.PostTodosPanel({el:this.$(".todo_actions"),model:this.model}),this.leftSidebarVoter=new good.citizen.views.LeftSidebarVoter({el:$(".interaction-count"),model:this.model})},n.prototype.render=function(){return this.actionsPanel.render(),this.voteDrawer.toggle(),this.thinkIsGood.toggle(),this.todosPanel.render()},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.FeedPanel=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="body",n.prototype.initialize=function(){return this.feedItemCells=[]},n.prototype.render=function(){var e,t,n,r=this;t=new good.citizen.collections.Posts,e=".post[data-slug]:not(.js-loaded),.follow[data-slug]:not(.js-loaded),.comment[data-slug]:not(.js-loaded)",n=_.map(this.$el.find(e),function(e){var n,i,s;return $(e).addClass("js-loaded"),s=$(e).data("slug"),i=new good.citizen.models.Post({slug:s}),t.add(i),n=new good.citizen.views.FeedItemCell({model:i,collection:t,el:e}),n.render(),r.feedItemCells.push(n),s}),n=_.reject(n,function(e){return e===void 0});if(!_.isEmpty(n))return t.fetchVotes(n),t.fetchTodos(n)},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.FirefoxUploadFileHack=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.events={click:"bubbleClickEventFromLabelToInput"},n.prototype.bubbleClickEventFromLabelToInput=function(){if($.browser.mozilla)return $("#"+this.$el.attr("for")).click()},n}(good.citizen.views.BaseView)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};good.citizen.views.FloatingFooter=function(t){function r(){return this.getFooterPosition=e(this.getFooterPosition,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.el=".floating_footer",r.prototype.events={"click .floating_footer_home_btn":"scrollToTop"},r.prototype.initialize=function(e){return this.$el.css("display","block")},r.prototype.scrollToTop=function(){return $("body:not(:animated), html:not(:animated)").animate({scrollTop:0},600)},r.prototype.getFooterPosition=function(){var e,t;if($("li.feed-item").not(".hidden").last().position()!==null)return t=$("li.feed-item").not(".hidden").last().height()-$(".floating_footer").height(),e=$("li.feed-item").not(".hidden").last().position().top+t,e},r.prototype.render=function(e){if(!e)return this.$el.css("top",this.getFooterPosition());if(e!==null)return this.$el.css("top",e)},r}(Backbone.View)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ForYou=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="html",n.prototype.initialize=function(){return this.currentUser=window.good.citizen.currentUser,this.currentUser.on("change",this.render,this),this.header=new good.citizen.views.ForYouHeader,this.personalizedFeed=new good.citizen.views.PersonalizedFeed,this.$el.find(".takeover").prepend(this.header.el)},n.prototype.render=function(){return this.header.render(),this},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ForYouHeader=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.className="for-you-header",n.prototype.template=JST["templates/for_you_header"],n.prototype.initialize=function(){return this.currentUser=good.citizen.currentUser,this.dataBar=new good.citizen.views.DataBar},n.prototype.render=function(){return this.currentUser.loggedIn()===!0&&this.$el.html(this.template(this)+this.dataBar.render().el.outerHTML),this},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.HeroUnitView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="#hero_unit",n.prototype.template=JST["templates/hero_unit_view"],n.prototype.events=function(){return{"click a.close":"bindHeroUnitClose"}},n.prototype.bindHeroUnitClose=function(){return $.cookie("hide_explore_top",!0,{expires:1e4}),this.$el.fadeOut(),event.preventDefault()},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.HideStickyPostsInFeed=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el=".posts",n.prototype.initialize=function(e){var t=this;return e=e.split(","),_(e).each(function(e){return t.$el.find("[data-slug="+e+"]").addClass("hidden"),t.$el.find("[data-slug="+e+"]").hide()})},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.InfiniteAdView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="#homepage_feed",n.prototype.initialize=function(e){return this.currentPage=e,this.list=this.$el.find("ul.feed")},n.prototype.render=function(){var e;return this.list.children().last().css("margin-bottom",0),e="CitizenHP_baseboard_ad_"+this.generateID(),this.list.append('<div class = "ad" id ="'+e+'"></div>'),this.$("ul.feed .ad").css("margin","26px 0px"),this.newBaseboardAd(e),this.appendInfiniteAd(e)},n.prototype.renderByPage=function(e){return this.currentPage=e,this.render()},n.prototype.appendInfiniteAd=function(e){var t,n,r,i,s,o,u;if(this.currentPage>1)return n=this.$el.find("ul.feed .ad"),r=n.eq(n.length-2),t=r.attr("id"),i=t.substr(t.lastIndexOf("_")+1),$(".right-sidebar").append("<div class='infinite_ad_container' id='"+i+"'></div>"),s=$("#"+i),s.append("<div id='facebook-friends-view-"+i+"' class='facebook-friends-view'>        <a class='invite-friends' href='javascript:void(0);' data-authenticated=''></a></div>"),s.css("top",r.position().top+26),new good.citizen.views.FacebookFriendsView({el:$("#facebook-friends-view-"+i)}),o=document.title,u=window.location.pathname,good.citizen.socialPublisherHelper.bindFacebookTracking($("#facebook-friends-view-"+i+" .invite-friends"),"general",o,u),this.newMiddleAd(s),this.newMiddlePromoAd(s),this.newUpperAd(s)},n.prototype.newBaseboardAd=function(e){var t;return t=new good.citizen.views.AdHelper({id:e,sz:"728x90",pos:"baseboard"+this.currentPage,units:"CitizenHP"}),t.render()},n.prototype.newMiddleAd=function(e){var t,n;return n="CitizenHP_middle_ad_"+this.generateID(),e.append("<div class='ad' id='"+n+"'></div>"),t=new good.citizen.views.AdHelper({id:n,sz:"300x600",pos:"middle"+this.currentPage,units:"CitizenHP"}),t.render()},n.prototype.newMiddlePromoAd=function(e){var t,n;return n="CitizenHP_middlepromo_ad_"+this.generateID(),e.append("<div class='ad special' id='"+n+"'></div>"),t=new good.citizen.views.AdHelper({id:n,sz:"300x125",pos:"middlepromo"+this.currentPage,units:"CitizenHP"}),t.render()},n.prototype.newUpperAd=function(e){var t,n;return n="CitizenHP_upper_ad_"+this.generateID(),e.append("<div class='ad' id='"+n+"'></div>"),t=new good.citizen.views.AdHelper({id:n,sz:"300x250",pos:"upper"+this.currentPage,units:"CitizenHP"}),t.render()},n.prototype.generateID=function(){return Math.floor(Math.random()*Math.pow(10,12))},n.prototype.removeSecondToLastAds=function(){var e;return e=$(".infinite_ad_container"),e.eq(e.length-1).remove()},n}(Backbone.View)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.LeftSidebarVoter=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){return this.model.on("change:popularity",this.toggleVote,this)},n.prototype.events={"click .vote_enable":"vote"},n.prototype.vote=function(e){return good.citizen.currentUser.isNew()||this.model.vote(),e.preventDefault()},n.prototype.toggleVote=function(){return this.model.voted?(this.$(".vote_count").removeClass("vote_enable"),this.$(".think_is_good").removeClass("vote_enable")):(this.$(".vote_count").addClass("vote_enable"),this.$(".think_is_good").addClass("vote_enable"))},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.MixpanelView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.subscriptions={"user:super":"userSuperProperties","user:logout":"removeMixpanelCookies","track:pageview":"trackPageView","post:create":"trackPostSubmission","post:upvote":"trackUpvote","action:todo":"trackTodo","carousel:arrow":"trackCarouselArrowClick","facebook:invite":"trackFacebookInvite","share:content":"trackShareContent"},n.prototype.userSuperProperties=function(){var e,t,n,r,i,s;return s=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3],e=arguments[4],t=e.indexOf("assets/default-avatar")===-1,mixpanel.people.set({name:s,$email:r,slug:i,"display name":n,"profile image set":t,$last_login:new Date}),mixpanel.people.identify(s)},n.prototype.removeMixpanelCookies=function(){return mixpanel.unregister("distinct_id"),mixpanel.unregister("slug"),mixpanel.unregister("display name"),mixpanel.unregister("email"),mixpanel.unregister("profile image set")},n.prototype.trackPageView=function(){var e,t;return e=arguments[0],t=arguments[1],this.registerPageTrack(t,e),mixpanel.people.increment("pages viewed"),mixpanel.track("Pageview")},n.prototype.trackPostSubmission=function(){var e,t,n;return e=arguments[0],n=arguments[1],t=arguments[2],e==="bookmark"?(mixpanel.people.increment("links posted"),this.identifyUser(),mixpanel.track("Post Link")):(mixpanel.people.increment("dos posted"),this.identifyUser(),mixpanel.track("Post Do")),this.registerPageTrack(n,t)},n.prototype.trackUpvote=function(){var e,t;return t=arguments[0],e=arguments[1],this.registerPageTrack(t,e),mixpanel.people.increment("upvotes"),mixpanel.track("Upvote")},n.prototype.trackTodo=function(){var e,t,n;t=arguments[0],n=arguments[1],e=arguments[2],this.registerPageTrack(n,e);switch(t){case"Add To-Do":mixpanel.people.increment("to-do adds");break;case"Complete Do":mixpanel.people.increment("completed to-dos")}return this.identifyUser(),mixpanel.track(t)},n.prototype.trackCarouselArrowClick=function(){var e;return e=arguments[0],e["tab position"]=e["tab position"]-1,this.identifyUser(),mixpanel.track("Clicked Carousel",e)},n.prototype.registerPageTrack=function(e,t){var n,r;return r=this.determinePageType(e),n=good.citizen.currentUser.loggedIn(),r==="For You"&&(t="GOOD - For You"),mixpanel.register({"page name":t,"source page type":r,"page url":e,"logged in":n}),mixpanel.unregister("url")},n.prototype.identifyUser=function(){var e,t;return e=good.citizen.currentUser,e.loggedIn()?(t=e.get("username"),mixpanel.people.identify(t),mixpanel.identify(t)):(mixpanel.people.identify,mixpanel.identify)},n.prototype.trackFacebookInvite=function(){var e,t;return e=arguments[1],t=arguments[2],this.registerPageTrack(t,e),mixpanel.track("Facebook invite",{"invite type":arguments[0]})},n.prototype.trackShareContent=function(){var e;return e={},e.target=arguments[0],e["source page type"]=arguments[1],e["page name"]=document.title,e["page url"]=window.location.pathname,mixpanel.track("Share Content",e)},n.prototype.determinePageType=function(e){var t,n;t=e.split("/")[1];switch(t){case"posts":return n="Post";case"members":return n="Profile";case"explore":return n="Explore";case"everyone":return n="For Everyone";case"":return n="For You";default:return n="Topic"}},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.PageSelector=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){var e=this;return this.$('input[name="page"]').change(function(){return e.$el.submit()})},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ParticipantCell=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.tagName="a",n.prototype.template=JST["templates/participant_cell"],n.prototype.initialize=function(){var e;return e=""+_.result(this.model,"alt_name"),this.$el.attr({href:"/members/"+_.result(this.model,"slug"
)}),this.$el.attr({alt:e}),this.$el.attr({title:e})},n}(good.citizen.views.BaseView)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};good.citizen.views.PersonalizedFeed=function(t){function r(){return this.paginate=e(this.paginate,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.el="#homepage_feed",r.prototype.initialize=function(){return this.collection=new good.citizen.collections.PersonalizedPosts,this.currentPage=1,this.loading=!1,this.list=null,this.render(),$(window).bind("scroll.paginate",this.paginate)},r.prototype.render=function(){if(this.loading)return;return this.loading=!0,$(".spinner").show(),this.collection.fetch({data:{scope:"personalized",page:this.currentPage},dataType:"html",success:$.proxy(this.replacePopularPostsWithPersonalizedPosts,this),error:$.proxy(this.hideSpinner,this)})},r.prototype.replacePopularPostsWithPersonalizedPosts=function(e,t){var n,r,i;return this.list?this.list.append(t):(this.$el.append(t),this.list=this.$el.find("ul.feed")),i=new good.citizen.views.InfiniteAdView(this.currentPage),$(t).is(".nothing")?($(window).unbind("scroll.paginate"),i.removeSecondToLastAds()):$(t).is(".nothing")||($(t).is(".day_one")||(r=new good.citizen.views.FloatingFooter),i=new good.citizen.views.InfiniteAdView(this.currentPage),i.render(),this.timestamps=new good.citizen.views.Timestamp),n=new good.citizen.views.FeedPanel,n.render(),this.currentPage++,this.loading=!1,$(".spinner").hide()},r.prototype.hideSpinner=function(e,t){return $(".spinner").hide()},r.prototype.paginate=function(){var e;$(".floating_footer")&&$(window).scrollTop()>$(".floating_footer").position().top+$(".floating_footer").height()&&(e=new good.citizen.views.FloatingFooter,e.render());if($(window).scrollTop()>$(document).height()-$(window).height()-660)return this.render()},r}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.PostActionsPanel=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["templates/post_actions_panel"],n.prototype.initialize=function(e){return this.model.on("change:popularity",this.toggleVote,this)},n.prototype.events={"click .its-good":"vote"},n.prototype.vote=function(e){return good.citizen.currentUser.isNew()||this.model.vote(),e.preventDefault()},n.prototype.toggleVote=function(){return this.model.voted?(this.$el.addClass("voted"),this.$el.children(".its-good").remove(),this.$el.append('<span class="its-already-good">It&#39;s GOOD</span>')):this.$el.removeClass("voted")},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.PostTodosInviteFriendsPanel=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["templates/post_todos_invite_friends_panel"],n.prototype.initialize=function(){var e;return this.$fb_container=this.$el.find(".fb_invite_container"),this.post_slug=this.model.attributes.slug,this.$fb_container.find("a").length===0&&(e="fb_"+this.post_slug,this.$fb_container.append(this.template({fb_id:e})),new good.citizen.views.FacebookFriendsView({el:this.$("#"+e),name:this.getTodoName(),description:this.getTodoDescription(),link:this.getTodoLink()})),this.bindTracking()},n.prototype.getTodoName=function(){var e;return e=this.$el.attr("data-title"),"Join Me: "+e},n.prototype.getTodoDescription=function(){var e;return e=this.$el.find("article .action .body").text(),e.length===0?null:e},n.prototype.getTodoLink=function(){var e;return e="/posts/"+this.post_slug,""+e+"?utm_source=facebook&utm_medium=invite&utm_campaign=todo"},n.prototype.bindTracking=function(){var e,t;return e=document.title,t=window.location.pathname,this.$fb_container.find(".invite-friends").unbind("click"),good.citizen.socialPublisherHelper.bindFacebookTracking(this.$fb_container.find(".invite-friends"),"do",e,t)},n.prototype.show=function(){var e=this;return this.$fb_container.fadeIn(),this.$fb_container.find(".close").bind("click",function(){return e.$fb_container.fadeOut()})},n.prototype.hide=function(){return this.$fb_container.hide()},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.PostTodosPanel=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["templates/post_todos_panel"],n.prototype.avatarTemplate=JST["templates/avatar"],n.prototype.primaryButtonLabel=null,n.prototype.primaryButtonClass=null,n.prototype.secondaryButtonLabel=null,n.prototype.secondaryButtonClass=null,n.prototype.numberOfDoersDescription=null,n.prototype.avatarUser=null,n.prototype.authorDescription=null,n.prototype.initialize=function(e){return this.model.on("change:numberOfDoers",this.updateNumberOfDoers,this),this.model.doers.on("add remove reset",this.updateRecentDoers,this),this.model.contributions.on("add remove reset",this.updateAuthorArea,this),this.model.tags.on("add remove reset",this.updateAuthorArea,this),this.model.on("change:todo",this.changeTodoObject,this),this.doerCells=new Array,this},n.prototype.events={"mouseenter input.primary":"mouseEnter","mouseleave input.primary":"mouseLeave","mouseenter input.secondary":"mouseEnter","mouseleave input.secondary":"mouseLeave","click input.primary":"clickPrimaryButton","click input.secondary":"clickSecondaryButton"},n.prototype.render=function(){var e,t,r=this;return n.__super__.render.call(this),t=this.$el.find(".avatars"),t.empty(),_(this.doerCells).each(function(e){return t.append(e.render().el)}),this.authorDescription!=null&&(e=this.$el.parentsUntil("li","article").find(".authorship"),e.find(".authors").html(this.authorDescription),e.find(".avatars").html(this.avatarTemplate())),this},n.prototype.changeTodoObject=function(){return this.todo!=null&&this.todo.off!=null&&this.todo.off(),this.todo=this.model.get("todo"),this.todo!=null&&this.todo.on!=null&&this.todo.on("change",this.updateTodoButtons,this),this.updateTodoButtons(),this.updateNumberOfDoers(),this.updateAuthorArea()},n.prototype.updateTodoButtons=function(){switch(this.model.todoStatus()){case"none":this.skinPrimaryButton("Do it"),this.skinSecondaryButton("Done");break;case"started":this.skinPrimaryButton("To Do"),this.skinSecondaryButton("Cancel");break;case"completed":this.skinPrimaryButton("Done"),this.skinSecondaryButton("Cancel")}return this.updateAuthorArea()},n.prototype.updateNumberOfDoers=function(){var e;return e=this.model.get("numberOfDoers"),this.numberOfDoersDescription=function(){switch(e){case 0:return this.model.todoStatus()!=="none"?"You're in":"Be first to get in";case 1:return"1 other is in";default:return""+e+" others are in"}}.call(this),this.render(),this.model.todoStatus()!=="none"&&(e+=1),$(".todo_count").html(e)},n.prototype.updateRecentDoers=function(){var e=this;return this.doerCells=this.model.doers.map(function(e){return new good.citizen.views.ParticipantCell({model:e})}),this.render()},n.prototype.updateAuthorArea=function(){var e;e=this.ownerUser();if(e!=null)return this.updateAuthorDescription(e),e!=null&&e.slug()!==good.citizen.currentUser.slug()?this.avatarUser=e:this.model.todoStatus()==="none"?this.avatarUser=this.model.contributions.author():this.avatarUser=good.citizen.currentUser},n.prototype.ownerUser=function(){var e;return e=this.$el.parents("ul.feed","ul.feed"),e.data("owner_slug")!=null?new good.citizen.models.User({slug:e.data("owner_slug"),display_name:e.data("owner_name"),avatar_url:e.data("owner_avatar")}):null},n.prototype.ownerTodoStatus=function(){return this.$el.parents("ul.feed","ul.feed").data("todo_status")||"none"},n.prototype.updateAuthorDescription=function(e){return e.slug()!==good.citizen.currentUser.slug()?this.authorDescription=function(){switch(this.ownerTodoStatus()){case"started":return""+e.displayName()+" wants to do this";case"completed":return""+e.displayName()+" did this";default:return this.authorTodoActivity()||"Something to do"}}.call(this):this.authorDescription=function(){switch(this.model.todoStatus()){case"started":return"You want to do this";case"completed":return"You did this";default:return this.authorTodoActivity()||"Something to do"}}.call(this),this.model.tags.isEmpty()||(this.authorDescription+=" "+this.model.tags.tagHTML()),this.render()},n.prototype.authorTodoActivity=function(){var e;e=this.model.contributions.author();if(e!=null)switch(this.model.get("authorTodoStatus")){case"started":return""+e.displayName()+" wants to do this";case"completed":return""+e.displayName()+" did this";default:return""+e.displayName()+" shared something to do"}},n.prototype.mouseEnter=function(e){this.timeoutId!=null&&clearTimeout(this.timeoutId),this.secondaryButton().show(),e.stopImmediatePropagation();switch(this.model.todoStatus()){case"none":return this.skinPrimaryButton("To Do");case"started":return this.skinPrimaryButton("Done")}},n.prototype.mouseLeave=function(e){var t=this;e.stopImmediatePropagation();switch(this.model.todoStatus()){case"none":this.skinPrimaryButton("Do it");break;case"started":this.skinPrimaryButton("To Do")}return this.timeoutId=setTimeout(function(){return t.secondaryButton().fadeOut("fast")},200)},n.prototype.skinPrimaryButton=function(e){return this.primaryButtonLabel=e,this.primaryButtonClass=this.skinClassFor(e),this.skinButton("primary",this.primaryButtonLabel,this.primaryButtonClass)},n.prototype.skinSecondaryButton=function(e){return this.secondaryButtonLabel=e,this.secondaryButtonClass=this.skinClassFor(e),this.skinButton("secondary",this.secondaryButtonLabel,this.secondaryButtonClass)},n.prototype.skinButton=function(e,t,n){var r,i;return i=this.$el.find("."+e+"_box"),r=i.find("input"),r.attr("value",t),r.removeClass("doit todo done cancel"),r.addClass(n),i.removeClass("doit todo done cancel"),i.addClass(n)},n.prototype.skinClassFor=function(e){return e.replace(/\s/,"").toLowerCase()},n.prototype.primaryButton=function(){return this.$el.find("input.primary")},n.prototype.primaryIcon=function(){return this.$el.find(".primary_box")},n.prototype.secondaryButton=function(){return this.$el.find("input.secondary")},n.prototype.secondaryIcon=function(){return this.$el.find(".secondary_box")},n.prototype.clickPrimaryButton=function(){if(good.citizen.currentUser.loggedIn())return this.changeTodo(this.primaryButton().attr("value"))},n.prototype.clickSecondaryButton=function(){if(good.citizen.currentUser.loggedIn())return this.changeTodo(this.secondaryButton().attr("value"))},n.prototype.changeTodo=function(e){var t;t=this.model.todoStatus(),this.todosInviteFriends=new good.citizen.views.PostTodosInviteFriendsPanel({el:this.$el.closest("article").parent(),model:this.model});switch(e){case"To Do":if(t!=="started")return this.model.updateTodoStatus("started"),this.todosInviteFriends.show();break;case"Done":if(t!=="completed")return this.model.updateTodoStatus("completed"),this.todosInviteFriends.show();break;case"Cancel":if(t!=="none")return this.model.updateTodoStatus("none"),this.todosInviteFriends.hide()}},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.RegistrationModalBoxView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.id="registration-modal-box",n.prototype.attributes={style:"display: none"},n.prototype.render=function(){return this},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ScrapedImagesView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(){return this.$source=this.$('[data-scraped-images="source"]'),this.$target=this.$('[data-scraped-images="target"]'),this.$field=this.$(".image_picker"),this.$source.on("blur",$.proxy(this.scrapeImages,this)),this.currWindow=0,this.imageIndex=0,this.totalImagesLoaded=0,this.name=this.options.name||"bookmark",this.collection=new good.citizen.collections.Images,this.collection.on("reset",this.displayImages,this)},n.prototype.scrapeImages=function(){return this.collection.fetch({data:{url:this.$source.val()}})},n.prototype.displayImages=function(e){this.clearPreviouslyScrapedImages();if(!e.isEmpty())return this.createImageSelector(),this.loadImages(e)},n.prototype.clearPreviouslyScrapedImages=function(){return this.totalImagesLoaded=0,this.$target.empty(),this.$field.find("button").remove(),this.$field.hide()},n.prototype.createImageSelector=function(){var e,t;return t=this.make("button",{"data-direction":"prev","class":"prev disabled"},"&larr;"),e=this.make("button",{"data-direction":"next","class":"next disabled"},"&rarr;"),this.$field.prepend(t).append(e).find("button").bind("click.nav",$.proxy(this.scrollToNextImage,this))},n.prototype.scrollToNextImage=function(e){var t,n,r,i,s;e.preventDefault(),n=$(e.target);if(!n.hasClass("disabled"))return r=this.$target.find("label"),r.hide(),t=this.findImagesInCurrentWindow(this.imageIndex,r),t.show(),this.imageIndex+=n.data("direction")==="next"?1:-1,i=this.findImagesInCurrentWindow(this.imageIndex,r),t.hide(),i.show(),s=this.imageIndex===0||this.imageIndex+2===r.length-1,s&&n.addClass("disabled"),n.siblings().removeClass("disabled")},n.prototype.findImagesInCurrentWindow=function(e,t){return this.currWindow=$([t[e],t[e+1],t[e+2]])},n.prototype.loadImages=function(e){return e.each($.proxy(this.createAndLoadImageElement,this))},n.prototype.createAndLoadImageElement=function(e){var t;return t=this.createImageElement({src:e.get("src")}),this.loadImageElement(t)},n.prototype.createImageElement=function(e){return $(this.make("img",e))},n.prototype.loadImageElement=function(e){var t=this;return e.load(function(e){var n,r,i,s;n=e.target,r=n.width>210&n.height>210;if(r)return s=t.make("input",{type:"radio",name:""+t.name+"[remote_image_url]",value:n.src}),i=t.make("label",{},[n,s]),t.$target.append(i),t.totalImagesLoaded+=1,t.totalImagesLoaded>3&&t.$("button.next").removeClass("disabled"),t.totalImagesLoaded===1&&t.selectFirstImage(),t.$field.show()})},n.prototype.selectFirstImage=function(){return this.$target.find("label:first").find('input[type="radio"]:first').attr("checked","checked"),this.$target.find("img:first").addClass("selected").after("<a href='#' id='deselect'>x</a>")},n}(good.citizen.views.BaseView)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};good.citizen.views.Search=function(t){function r(){return this.paginate=e(this.paginate,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.el="#search",r.prototype.initialize=function(e){return this.queryForm=this.$("#search-form"),this.queryForm.bind("submit",$.proxy(this.onSubmitQuery,this)),this.query=e!=null&&e.query!=null?e.query:"",this.filter=e!=null&&e.filter!=null?e.filter:"all",this.page=1,this.searchFilters=new good.citizen.views.SearchFilters({parent:this}),this.searchFilters.on("changeSearchFilter",this.onChangeFilter,this),this.resultsCollection=new good.citizen.collections.SearchResults,this.resultsContainer=this.$(".search-results"),this.paginating=!1,this.allowedToPaginate=!0,this.paginatingIndicator=$(".search.spinner"),$(window).bind("scroll.paginate",this.paginate)},r.prototype.render=function(){return this.searchFilters.render()},r.prototype.updateQueryParameters=function(e){return this.paginating||this.obscureResultsContainer(),e.query!=null&&(this.query=e.query),e.filter!=null&&(this.filter=e.filter),e.page!=null&&(this.page=e.page),this.allowedToPaginate=!0,this.fetchResults()},r.prototype.onChangeFilter=function(e){return this.updateQueryParameters({filter:e,page:1})},r.prototype.onSubmitQuery=function(e){var t;return e.preventDefault(),t=$(e.currentTarget.query).val(),this.updateQueryParameters({query:t,page:1}),!1},r.prototype.loadNextPageOfSearchResults=function(){var e;if(this.paginating||!this.allowedToPaginate)return;return this.paginating=!0,this.paginatingIndicator.show(),this.filter==="all"&&(e="posts"),this.updateQueryParameters({page:++this.page,paginating:!0,filter:e})},r.prototype.fetchResults=function(){return this.resultsCollection.fetch({data:{query:this.query,filter:this.filter,page:this.page},dataType:"html",complete:$.proxy(this.displaySearchResults,this)})},r.prototype.displaySearchResults=function(e){return this.paginating?(e.responseText===""&&(this.allowedToPaginate=!1),this.resultsContainer.append(e.responseText),this.paginating=!1,this.paginatingIndicator.hide()):(this.revealResultsContainer(),this.resultsContainer.html(e.responseText))},r.prototype.obscureResultsContainer=function(){return this.resultsContainer.addClass("whiteout")},r.prototype.revealResultsContainer=function(){return this.resultsContainer.removeClass("whiteout")},r.prototype.paginate=function(){if($(window).scrollTop()>$(document).height()-$(window).height()-660)return this.loadNextPageOfSearchResults()},r}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.SearchFilters=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el=".search-filters",n.prototype.template=JST["templates/search_filters"],n.prototype.events={"click a[data-filter]":"onFilterSelected"},n.prototype.render=function(){return this.$el.html(this.template()),this},n.prototype.onFilterSelected=function(e){return this.filter=$(e.target).data("filter"),this.trigger("changeSearchFilter",this.filter),this.setSelectedState($(e.target))},n.prototype.setSelectedState=function(e){return this.$el.find("a[data-filter]").removeClass("active"),e.addClass("active")},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.StickyCarouselView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="body",n.prototype.render=function(){return this.stickyCarousel()},n.prototype.stickyCarousel=function(){return $(".sticky_tags a[data-slug]").bind("click",$.proxy(this.showCurrentSticky,this)),$(".carousel .next").bind("click",$.proxy(this.showNextSticky,this)),$(".carousel .back").bind("click",$.proxy(this.showPreviousSticky,this)),this.limitCarouselAuthorship($(".sticky_posts .post[data-slug] .authors:first")),this.setCarouselTitleFontSize($(".sticky_posts .post[data-slug] h3:first")),this.setCarouselTagPadding()},n.prototype.showCurrentSticky=function(e){var t,n;return e.preventDefault(),t=$(e.target),n=t.data("slug"),$(".sticky_tags a[data-slug]").removeClass("active"),$(".sticky_tags a[data-slug="+n+"]").addClass("active"),$(".sticky_posts .post[data-slug]").hide(),$(".sticky_posts .post[data-slug="+n+"]").show(),this.limitCarouselAuthorship($(".sticky_posts .post[data-slug="+n+"] .authors")),this.setCarouselTitleFontSize($(".sticky_posts .post[data-slug="+n+"] h3")),$(".homepage h3 a").unbind()},n.prototype.showNextSticky=function(e){var t,n,r,i,s,o;e.preventDefault(),n=$(".sticky_tags a[data-slug]");for(t=s=0,o=n.length;s<o;t=++s)r=n[t],$(r).hasClass("active")&&(i=t);return i<n.length-1?i++:i=0,$(n[i]).trigger("click")},n.prototype.showPreviousSticky=function(e){var t,n,r,i,s,o;e.preventDefault(),n=$(".sticky_tags a[data-slug]");for(t=s=0,o=n.length;s<o;t=++s)r=n[t],$(r).hasClass("active")&&(i=t);return i>0?i--:i=4,$(n[i]).trigger("click")},n.prototype.limitCarouselAuthorship=function(e){var t,n,r;n=20;if($(e).height()>n)return r=$(e).children(".tags").html(),t=r.indexOf(" and"),r=r.slice(0,t),r=r.replace(/,/i," and"),$(e).children(".tags").html(r)},n.prototype.setCarouselTitleFontSize=function(e){var t;t=158;if($(e).height()>t)return $(e).addClass("shift-1")},n.prototype.setCarouselTagPadding=function(){var e;return e=12,$(".sticky_tags li a").each(function(t,n){if($(n).height()>e)return $(n).addClass("shift-1")})},n}(good.citizen.views.BaseView)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};good.citizen.views.SubmissionFormView=function(t){function r(){return this.formValidation=e(this.formValidation,this),this.fetchParams=e(this.fetchParams,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.template=JST["templates/submission_form_view"],r.prototype.initialize=function(){return this.bookmark=new good.citizen.models.Bookmark,this.action=new good.citizen.models.Action,this.dict={type:"bookmark"}},r.prototype.events={"click #bookmark_tab":"showBookmark","click #action_tab":"showAction","click .simplemodal-close":"closeSimplemodal","click .caption label small a":"showImageUpload","click .images label img":"outlineSelectedImage","change .image_upload input[type=file]":"updateTextField","click #styled_field label a":"deleteFileUploadField","click #deselect":"deselectImage"},r.prototype.attributes={id:"submission-modal-box"},r.prototype.fetchParams=function(e){var t,n;return this.$("#new_action_url").val()===""?n=null:n=this.$("#new_action_url").val(),e.id==="new_bookmark"?t={title:this.capitalizeFirstLetter(this.$("#new_bookmark_title").val()),url:this.$("#new_bookmark_url").val(),body:this.$("#new_bookmark_body").val(),tag_list:this.$("#bookmark_tag_list").val(),remote_image_url:this.$("input:checked").val()}:e.id==="new_action"&&(t={title:this.capitalizeFirstLetter(this.$("#new_action_title").val()),url:n,body:this.$("#new_action_body").val(),tag_list:this.$("#action_tag_list").val(),remote_image_url:this.$("input:checked").val()}),t},r.prototype.capitalizeFirstLetter=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},r.prototype.render=function(){return this.$el.html(this.template()),this.showBookmark(),this},r.prototype.showImageUpload=function(){return this.$(".image_upload").show()},r.prototype.showSubmitSpinner=function(){return this.$(".spinner.submit").show()},r.prototype.outlineSelectedImage=function(e){var t;t=e.target||e.srcElement,this.$(".images label img").removeClass("selected"),this.$(t).addClass("selected");if(this.$(t).parent().find("#deselect").length===0)return this.$(t).after("<a href='#' id='deselect'>x</a>")},r.prototype.updateTextField=function(e){var t,n;return t=e.target||e.srcElement,n=this.$(t).val(),this.$("#styled_field input[type=text]").val(n),this.$("#styled_field label a").show()},r.prototype.deleteFileUploadField=function(e){var t;return t=this.$(".image_upload input[type=file]")[0],this.$("#styled_field input[type=file]").replaceWith(t),this.$("#styled_field input[type=text]").val(""),this.$("#styled_field label a").hide()},r.prototype.deselectImage=function(e){var t;return t=this.$(".selected"),t.siblings("input[type=radio]:checked").attr("checked",!1),t.removeClass("selected")},r.prototype.showBookmark=function(){var e,t,n,r,i;this.dict.type="bookmark",r=this.$("#bookmark_submission"),r.html(JST["templates/_form"](this.dict)),this.formValidation("bookmark"),i=new good.citizen.views.ScrapedImagesView({el:r}),n=new good.citizen.views.CharacterCounterView({el:this.$("#new_bookmark_title")}),t=new good.citizen.views.CharacterCounterView({el:this.$("#new_bookmark_body")}),e=new good.citizen.views.AutocompleteTagsView({el:this.$("#bookmark_tag_list")},{autoSelect:!0,showPrompts:!0}),r.show(),this.$("#action_submission").hide(),this.$("li#bookmark_tab").addClass("active");if(this.$("li#action_tab").hasClass("active"))return this.$("li#action_tab").removeClass("active")},r.prototype.showAction=function(){var e,t,n,r,i;this.dict.type="action",r=this.$("#action_submission"),r.html(JST["templates/_form"](this.dict)),this.formValidation("action"),i=new good.citizen.views.ScrapedImagesView({el:r}),t=new good.citizen.views.CharacterCounterView({el:this.$("#new_action_title")}),e=new good.citizen.views.CharacterCounterView({el:this.$("#new_action_body")}),n=new good.citizen.views.AutocompleteTagsView({el:this.$("#action_tag_list")},{autoSelect:!0,showPrompts:!0}),r.show(),this.$("#bookmark_submission").hide(),this.$("li#action_tab").addClass("active");if(this.$("li#bookmark_tab").hasClass("active"))return this.$("li#bookmark_tab").removeClass("active")},r.prototype.closeSimplemodal=function(){return $.modal.close()},r.prototype.renderSuccess=function(e,t){var n;return n=new good.citizen.views.ThankYouView({response:e,data:t}),this.publishPostCreate(),this.$el.html(n.render().el),n.moveCloseArrow()},r.prototype.publishPostCreate=function(){var e,t;return t=window.location.pathname,e=document.title,Backbone.Mediator.publish("post:create",submission_type,t,e)},r.prototype.renderFailure=function(){return this.$el.html("<h2>Failure your submission was not successful. Try again.</h2>")},r.prototype.formValidation=function(e){var t,n,r=this;return $.validator.addMethod("complete_url",function(e,t){return e===""?!0:(/^(https?|ftp):\/\//i.test(e)||(e="http://"+e,$(t).val(e)),$.validator.methods.url.apply(this,arguments))},"URL is invalid"),e==="bookmark"?(t=this.bookmark,n=this.$("#new_bookmark")):e==="action"&&(t=this.action,n=this.$("#new_action")),n.validate({validClass:"valid",errorClass:"invalid",onkeyup:!1,onclick:!1,onfocusout:function(e){var t;t=r.$(e).attr("id");if(t==="new_bookmark_url"||t==="new_action_url")return r.$(e).valid()},rules:{"new_bookmark[url]":{complete_url:!0,required:!0,remote:{url:"/api/bookmarks/url_check",async:!0,beforeSend:function(){return $(".spinner.url").show()},complete:function(){return $(".spinner.url").hide()},dataFilter:function(e){var t;return t=JSON.parse(e),t.errors.hasOwnProperty("url")?"false":"true"}}},"bookmark[title]":{required:!0},"bookmark[tag_list]":{required:!0},"new_action[url]":{required:!1,complete_url:!0,remote:{url:"/api/actions/url_check",async:!0,beforeSend:function(){return $(".spinner.url").show()},complete:function(){return $(".spinner.url").hide()},dataFilter:function(e){var t;return t=JSON.parse(e),t.errors.hasOwnProperty("url")?"false":"true"}}},"action[title]":{required:!0},"action[tag_list]":{required:!0}},messages:{"new_bookmark[url]":{remote:"Link already posted. Try again."},"bookmark[title]":{required:"Title required"},"bookmark[tag_list]":{required:"One topic required"},"new_action[url]":{url:"URL is invalid",remote:"Link already posted. Try again."},"action[title]":{required:"Title required"},"action[tag_list]":{required:"One topic required"}},errorPlacement:function(e,t){return e.appendTo(t.prev())},submitHandler:function(e){var n;return n=r.fetchParams(e),t.save(n,{beforeSend:function(){return r.showSubmitSpinner()},success:function(e,t){return r.renderSuccess(t,n)},error:function(e,t){return r.renderFailure()}})},showErrors:function(e,t){var n,r;return r=$("[name=new_bookmark\\[url\\]]"),n=$("[name=new_action\\[url\\]]"),e["new_bookmark[url]"]?r.parent().removeClass("valid"):r.parent().addClass("valid"),e["new_action[url]"]?n.parent().removeClass("valid"):n.val()?n.parent().addClass("valid"):n.parent().removeClass("valid"),this.defaultShowErrors()}})},r}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.SubmissionModalView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="body",n.prototype.events={"click a#submission_form_button":"renderSubmissionForm","click a#topic_submission_form_button":"renderSubmissionForm","click a#topic_share_your_own":"renderSubmissionForm"},n.prototype.renderSubmissionForm=function(){var e,t,n,r,i=this;return t=560,n=775,r=($(window).height()-t)/2-10,r=r>0?r:0,e=($(window).width()-n)/2,this.submissionFormView=new good.citizen.views.SubmissionFormView,$("body").append(this.submissionFormView.render().el),this.submissionFormView.$el.length&&(this.submissionFormView.$el.modal({autoResize:!0,focus:!1,containerCss:{backgroundColor:"transparent",height:t,width:n,position:"absolute",top:r,overflow:"visible"},opacity:95,overlayCss:{backgroundColor:"#fff",cursor:"pointer"},onClose:function(e){return e.data.fadeOut("fast",function(){return e.container.fadeOut("fast",function(){return e.overlay.fadeOut("fast",function(){return $.modal.close(),$("#submission-modal-box").remove()})})})}}),$("#simplemodal-container .modalCloseImg").hide()),this.submissionFormView.$el.animate({height:t,width:n,top:r,left:e},0),$("#simplemodal-overlay").bind("click",function(){return i.submissionFormView.closeSimplemodal()})},n.prototype.render=function(){return this},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.TaglineView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="#tagline_js",n.prototype.template=JST["templates/tagline_view"],n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ThankYouView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["templates/thank_you_view"],n.prototype.events={"click a.facebook":"shareOnFacebook","click a.twitter":"twitterPopup"},n.prototype.initialize=function(){return this.twitterUrl=null,this.response=this.options.response,this.form_data=this.options.data,this.postLink=window.location.protocol+"//"+window.location.host+"/posts/"+this.response.slug,this.buildTwitterUrl()},n.prototype.attributes={id:"thank-you-view"},n.prototype.render=function(){var e;return e={slug:this.response.slug,url:this.twitterUrl},this.$el.html(this.template(e)),this},n.prototype.moveCloseArrow=function(){var e;return e=$("#thank-you-view").position().top,$("#simplemodal-container .modalCloseImg").show().css({top:e,right:0,borderStyle:"solid",borderWidth:"1px 1px 0px 0px",borderColor:"#E1E3E6"})},n.prototype.shareOnFacebook=function(){var e;return e={method:"feed",link:this.postLink,picture:this.form_data.remote_image_url,name:this.form_data.title,description:this.form_data.body},FB.ui(e),Backbone.Mediator.publish("share:content","Facebook","Post confirmation")},n.prototype.buildTwitterUrl=function(){var e;return e="https://twitter.com/share",this.twitterUrl=e+"?url="+encodeURIComponent(this.postLink)+"&text="+encodeURIComponent(this.form_data.title)},n.prototype.twitterPopup=function(e){var t,n,r,i,s;return e.preventDefault(),s=575,t=400,n=($(window).width()-s)/2,i=($(window).height()-t)/2,r="status=1,width="+s+",height="+t+",top="+i+",left="+n,window.open(this.twitterUrl,"twitter",r),Backbone.Mediator.publish("share:content","Twitter","Post confirmation")},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=
n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.ThinkIsGood=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["templates/think_is_good"],n.prototype.initialize=function(){return this.model.on("change:popularity",this.toggle,this)},n.prototype.toggle=function(){var e,t;return e=this.model.get("popularity"),t=e===1,e>0?(this.count=""+e+" "+(t?"person":"people"),this.think_is_good=""+(t?"thinks":"think")+" this is good",this.$el.show(),this.render()):this.$el.hide(),this},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.Timestamp=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.initialize=function(e){return $("time").each(function(){var e,t;return t=$(this),e=t.attr("datetime"),t.html(good.citizen.helpers.timeAgo(e))})},n}(Backbone.View)}.call(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}},t={}.hasOwnProperty,n=function(e,n){function i(){this.constructor=e}for(var r in n)t.call(n,r)&&(e[r]=n[r]);return i.prototype=n.prototype,e.prototype=new i,e.__super__=n.prototype,e};good.citizen.views.UnfollowButtonView=function(t){function r(){return this.toggleFollowForms=e(this.toggleFollowForms,this),r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.render=function(){var e,t,n,r,i;for(n=r=0,i=$("[data-follow_type][data-follow_slug]").length;r<=i;n=r+=20)e=_.reduce($("[data-follow_type][data-follow_slug]").slice(n,n+20),this.toParam,{}),_.isEmpty(e)||(t=new good.citizen.collections.Follows,t.on("reset",this.toggleFollowForms),t.fetch({data:{follows:e}}));return $(".follow_button_spinner_container").fadeOut("slow")},r.prototype.toParam=function(e,t,n){return e[n]={type:$(t).data("follow_type"),slug:$(t).data("follow_slug")},e},r.prototype.toggleFollowForms=function(e){var t=this;return e.each(function(e){return $("[data-follow_type="+e.get("type")+"][data-follow_slug="+e.get("slug")+"]").each(function(e,n){return $(n).data("unfollowable")!=null?t.replaceWithUnfollowForm($(n)):t.replaceWithFollowingText($(n))})})},r.prototype.replaceWithUnfollowForm=function(e){return e.find("input[type=submit]").val("Following").hover(function(){return $(this).val("Unfollow")},function(){return $(this).val("Following")}).end().append('<input name="_method" type="hidden" value="delete">').attr({action:e.attr("action").replace(/\/follow$/,"/unfollow")}).addClass("unfollow").removeClass("follow")},r.prototype.resetFollowForm=function(e){return e.find("input[type=submit]").val("Follow").hover(function(){return $(this).val("Follow")},function(){return $(this).val("Follow")}).end(),e.find("[value=delete]").remove(),e.attr({action:e.attr("action").replace(/\/unfollow$/,"/follow")}).removeClass("unfollow").addClass("follow")},r.prototype.replaceWithFollowingText=function(e){var t;return t=$("<span />").attr("data-follow_slug",e.data("follow_slug")).attr("data-follow_type",e.data("follow_type")).text("Following"),e.replaceWith(t)},r}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.UserDataBar=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="#user-dash",n.prototype.template=JST["templates/_user_data_bar"],n.prototype.events={"click .activity":"showActivity","click .followers":"showFollowers","click .following":"showFollowing","click .to-dos":"showTodos"},n.prototype.initialize=function(){return this.csrfParam=$('meta[name="csrf-param"]').attr("content"),this.csrfToken=$('meta[name="csrf-token"]').attr("content")},n.prototype.render=function(){return this.$el.append(this.template({model:this.model,active:"activity"}))},n.prototype.showActivity=function(){var e;return $(".takeover").removeClass("on-blur"),this.hideEmptyMessage(),$(".carousel").show(),$("#homepage_feed").show(),$("#user-feed").remove(),$(".data-bar").replaceWith(JST["templates/_user_data_bar"]({model:this.model,active:"activity"})),e=new good.citizen.views.PersonalizedFeed({model:this.model}),e.render()},n.prototype.showFollowers=function(){var e,t,n,r,i,s;$(".takeover").addClass("on-blur"),$(".data-bar").replaceWith(JST["templates/_user_data_bar"]({model:this.model,active:"followers"})),$("#homepage_feed").hide(),$("#user-feed").remove(),$("#homepage_feed").parent().append('<div id="user-feed"><ul class="followers users" /></div>'),t=_.result(this.model,"followers");if(t.length===0)return this.showEmptyMessage("Get involved!","Start following, joining discussions, and posting to gain followers.");this.hideEmptyMessage(),s=[];for(r=0,i=t.length;r<i;r++)e=t[r],n={model:e,csrfParam:this.csrfParam,csrfToken:this.csrfToken},s.push($(".followers.users").append(JST["templates/_follower"](n)));return s},n.prototype.showFollowing=function(){var e,t,n,r,i,s,o,u,a,f,l;$(".takeover").addClass("on-blur"),$(".data-bar").replaceWith(JST["templates/_user_data_bar"]({model:this.model,active:"following"})),$("#homepage_feed").hide(),$("#user-feed").remove(),$("#homepage_feed").parent().append('<div id="user-feed"><ul class="following tags" /><ul class="followers users" /></div>'),$(".following.tags").prepend('<h2 class="topics">TOPICS</h2>'),n=_.result(this.model,"followed_tags"),i=_.result(this.model,"followed_users"),e=n.length+i.length;if(e===0)return this.showEmptyMessage("Not much to see here!",'Click <a href="/explore">here</a> to explore topics and members to follow.');this.hideEmptyMessage();for(o=0,a=n.length;o<a;o++)t=n[o],s={model:t,csrfParam:this.csrfParam,csrfToken:this.csrfToken},$(".following.tags").append(JST["templates/_following_tag"](s));$(".followers.users").prepend('<h2 class="members">MEMBERS</h2>'),l=[];for(u=0,f=i.length;u<f;u++)r=i[u],s={model:r,csrfParam:this.csrfParam,csrfToken:this.csrfToken},l.push($(".followers.users").append(JST["templates/_follower"](s)));return l},n.prototype.showTodos=function(){return $(".takeover").addClass("on-blur"),$(".data-bar").replaceWith(JST["templates/_user_data_bar"]({model:this.model,active:"todos"}))},n.prototype.showEmptyMessage=function(e,t){var n;return n=$(".day_one"),n.length===0&&(n=$("<div class='day_one'><p></p><p></p></div>"),n.insertBefore($("#homepage_feed"))),$(".day_one p").html(e),$(".day_one p + p").html(t),n.show()},n.prototype.hideEmptyMessage=function(){return $(".day_one").hide()},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.UserOverlayView=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["templates/user_overlay_view"],n.prototype.events={"click .step_two":"showStepTwo","click .step_one":"showStepOne","click .step_three":"showStepThree"},n.prototype.showStepTwo=function(){return this.$("img.user_overlay").attr("src","/assets/02-welcome-overlay-kb.jpeg"),this.$(".step_two").remove(),this.$("map[name=user_overlay]").append("<area shape='rect' coords='128, 451, 151, 491' href='#' alt='Continue' class='step_one' />"),this.$("map[name=user_overlay]").append("<area shape='rect' coords='639, 228, 690, 282' href='#' alt='Continue' class='step_three' />")},n.prototype.showStepOne=function(){return this.$("img.user_overlay").attr("src","/assets/01-welcome-overlay-kb.jpeg"),this.$(".step_one").remove(),this.$(".step_three").remove(),this.$("map[name=user_overlay]").append("<area shape='rect' coords='639, 228, 690, 282' href='#' alt='Continue' class='step_two' />"),this.$("map[name=user_overlay]").append("<area shape='rect' coords='340, 447, 360, 499' href='#' alt='Continue' class='step_two' />"),this.$("map[name=user_overlay]").append("<area shape='rect' coords='550, 447, 645, 499' href='#' alt='Continue' class='step_three' />")},n.prototype.showStepThree=function(){return $(".login").addClass("force_login"),$(".user_overlay_close").click()},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.VoteDrawer=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.template=JST["templates/vote_drawer"],n.prototype.initialize=function(){return this.model.on("change:popularity",this.toggle,this)},n.prototype.toggle=function(){var e,t,n=this;return e=this.model.get("popularity")||0,e!==0?(t=e===1,this.count=""+e+" "+(t?"person":"people"),this.think_is_good=" "+(t?"thinks":"think")+" this is good",$(".vote_count").html(e),this.render()):e===0&&(this.count="Think it's good?",this.think_is_good="",this.render()),this.model.has("voters")&&_(this.model.get("voters")).each(function(e){var t;return t=new good.citizen.views.ParticipantCell({model:e}),n.$el.find(".avatars").append(t.render().el)}),this},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.views.WelcomeModal=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.el="body",n.prototype.events={"click a":"setUserOverlayCookie"},n.prototype.setUserOverlayCookie=function(){return $.cookie("hide_user_overlay",!0,{expires:1e4})},n.prototype.renderable=function(){return!$.cookie("hide_user_overlay")&&!$.cookie("inviter_display_name")},n.prototype.render=function(){var e,t,n=this;if(this.renderable())return t=($(window).height()-699)/2,t=t>0?t:0,e=($(window).width()-699)/2,this.userOverlayView=new good.citizen.views.UserOverlayView,$("body").append(this.userOverlayView.render().el),this.userOverlayView.$el.length&&(this.userOverlayView.$el.modal({autoResize:!0,focus:!1,containerCss:{backgroundColor:"white",height:503,width:699,position:"absolute",top:t,overflow:"hidden"},opacity:75,overlayCss:{backgroundColor:"#fff"},closeClass:"user_overlay_close",onClose:function(e){return e.data.fadeOut("fast",function(){return e.container.fadeOut("fast",function(){return e.overlay.fadeOut("fast",function(){return $.modal.close(),$(".user_overlay").remove(),$('map[name="user_overlay"]').remove(),$(".login.force_login").click()})})})}}),$("#simplemodal-container").css({position:"absolute",height:503,top:60})),this.userOverlayView.$el.animate({height:503,width:699,top:t,left:e},0)},n}(good.citizen.views.BaseView)}.call(this),function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t};good.citizen.routers.ApplicationRouterMobile=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.routes={"":"forYou","*actions":"default"},n.prototype.initialize=function(){var e,t,n,r,i,s;t=window.location.pathname.substr(1),i=Backbone.history.handlers,s=[];for(n=0,r=i.length;n<r;n++){e=i[n];if(e.route.test(t)){e.callback(t);break}s.push(void 0)}return s},n.prototype.forYou=function(){return(new good.citizen.views.ForYouMobile).render()},n.prototype["default"]=function(){},n}(Backbone.Router)}.call(this),function(){$(function(){return $("#change_password").bind("click",function(e){var t;return t=$(".old_password, .new_password, .password_submit"),t.is(":visible")?t.hide():t.show(),e.preventDefault()}),$("#edit_user .email input[type=submit]").bind("click",function(e){var t;return t=$(".old_password, .new_password, .password_submit"),t.hide()}),$("#current_user_email a").bind("click",function(e){var t;return t=$(".new_email"),t.is(":visible")?t.hide():t.show(),e.preventDefault()}),$("#edit_user .password input[type=submit]").bind("click",function(e){var t;return t=$(".new_email"),t.hide()}),$("#edit_user.email_password").validate({debug:!0,errorClass:"invalid",rules:{"user[email]":{email:!0},"user[email_confirmation]":{email:!0,equalTo:"#user_email"},"user[old_password]":{required:!0,minlength:6},"user[new_password]":{required:!0,minlength:6},"user[new_password_confirmation]":{required:!0,minlength:6,equalTo:"#user_new_password"}},messages:{"user[email]":{required:"Please enter a valid email address",minlength:"Please enter a valid email address"},"user[email_confirmation]":{required:"Please repeat your email",equalTo:"please enter the same email address as above"},"user[old_password]":{required:"Please provide your current password",rangelength:jQuery.format("Enter at least {0} characters")},"user[new_password]":{required:"Please provide your new password",minlength:jQuery.format("Enter at least {0} characters")},"user[new_password_confirmation]":{required:"Please repeat your password",minlength:jQuery.format("Enter at least {0} characters"),equalTo:"Please enter the same password"}},errorPlacement:function(e,t){return e.appendTo(t.parent())},submitHandler:function(e){return e.submit()}})})}.call(this),function(){$(function(){return(new good.citizen.views.ApplicationViewMobile).render(),new good.citizen.routers.ApplicationRouterMobile})}.call(this);